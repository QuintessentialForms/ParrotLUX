<!DOCTYPE HTML>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, touch-action:none, interactive-widget:resizes-content" />
        <title>AI Canvas</title>
        <link rel="stylesheet" type="text/css" href="canvas.css" />
        <!--script type="text/javascript" src="store.js"></script-->
        <style>
/* We have this inlined during dev b/c the stylesheet won't refresh on tablet. :-/ */
body {
    overflow: hidden;
    overscroll-behavior: none;
    touch-action: none;
    height:100%;
    height:100vh;
    background-color: rgb(128,128,128);
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    user-select: none;
    --animation-speed: 0.2s; /* also set in JS, as UI.animationMS */
}
#main, #cnv, #ui, #node-drag-overlay, #gnv, #underlay {
    position: absolute;
    left:0; top:0; right:0; bottom:0;
    width:100vw; height:100vh;
    user-select: none;
}
#gnv {
    pointer-events: all;
}

#underlay > .hidden {
    opacity: 0;
}

#overlay {
    z-index: 10000000;
}
#overlay > .real-input.hidden {
    pointer-events: none;
    opacity: 0;
}
#overlay .hidden .overlay-element {
    opacity: 0;
    transform: scale(0.9,0.9)
}
.overlay-element.pushed {
    transform: scale(0.9,0.9);
}
#overlay > .real-input {
    pointer-events: all;
}
#overlay > .overlay-background {
    position: absolute;
    left: 0; top: 0;
    width:100vw; height:100vh;
    background-color: rgba(0,0,0,0.75);
    z-index: 10001000;
}

.overlay-background.hidden > #generating-canvas {
    filter:blur(20px);
    transform: scale(0.9,0.9);
    opacity: 0;
}
#generating-canvas {
    position:absolute;
    left:calc( 50vw - ( min( 100vw, 100vh ) / 6 ) );
    top: 5rem;
    width: calc( min( 100vw, 100vh ) / 3 );
    height: calc( min( 100vw, 100vh ) / 3 );
    box-sizing: border-box;
    margin:0;
}

#error-notification-overlay .overlay-close-button:hover {
    border: 1px solid var(--white);
}
#error-notification-overlay .overlay-close-button {
    border: 1px solid transparent;
    position:absolute;
    left:calc( 50vw - ( min( 100vw, 100vh ) / 6 ) );
    top: 1.5rem;
    width: 3rem;
    height: 3rem;
    border-radius: 1rem;
    background-image: url('icon/x.png');
    background-size:contain;
    background-position:center;
    background-repeat:no-repeat;
    box-sizing: border-box;
}
#error-notification-overlay .overlay-error-notification {
    position:absolute;
    left:calc( 50vw - ( min( 100vw, 100vh ) / 6 ) );
    top: 5rem;
    width: calc( min( 100vw, 100vh ) / 3 );
    height: calc( min( 100vw, 100vh ) / 6 );
    resize: none;
    box-sizing: border-box;
    margin:0;
    padding:1rem;
    border-radius: 1rem;
    border:1px solid var(--mid);
    color: var(--white);
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    align-items: center;
    text-align: center;
    overflow-y: scroll;
}
#error-notification-overlay .overlay-accept-button:hover {
    box-shadow: 0 0 1rem 0 var(--white);
}
#error-notification-overlay .overlay-accept-button {
    position:absolute;
    left:calc( ( 50vw + ( min( 100vw, 100vh ) / 6 ) ) - 6rem );
    top: calc( ( min( 100vw, 100vh ) / 6 ) + 6rem );
    width: 6rem;
    height: 3rem;
    border-radius: 1rem;
    background-color: var(--high);
    background-image: url('icon/check-black.png');
    background-size:contain;
    background-position:center;
    background-repeat:no-repeat;
    box-sizing: border-box;
}


#multiline-text-input-overlay .overlay-close-button:hover {
    border: 1px solid var(--white);
}
#multiline-text-input-overlay .overlay-close-button {
    border: 1px solid transparent;
    position:absolute;
    left:calc( 50vw - ( min( 100vw, 100vh ) / 6 ) );
    top: 1.5rem;
    width: 3rem;
    height: 3rem;
    border-radius: 1rem;
    background-image: url('icon/x.png');
    background-size:contain;
    background-position:center;
    background-repeat:no-repeat;
    box-sizing: border-box;
}
#multiline-text-input-overlay .overlay-text-input {
    position:absolute;
    left:calc( 50vw - ( min( 100vw, 100vh ) / 6 ) );
    top: 5rem;
    width: calc( min( 100vw, 100vh ) / 3 );
    height: calc( min( 100vw, 100vh ) / 6 );
    resize: none;
    box-sizing: border-box;
    margin:0;
    padding:1rem;
    border-radius: 1rem;
    border:1px solid black;
    background-color: var(--white);
}
#multiline-text-input-overlay .overlay-text-input:focus {
    outline:none;
    box-shadow: 0 0 1rem 0 var(--white);
}
#multiline-text-input-overlay .overlay-apply-button:hover,
#multiline-text-input-overlay .overlay-accept-button:hover {
    box-shadow: 0 0 1rem 0 var(--white);
}
#multiline-text-input-overlay .overlay-apply-button,
#multiline-text-input-overlay .overlay-accept-button {
    position:absolute;
    left:calc( ( 50vw + ( min( 100vw, 100vh ) / 6 ) ) - 6rem );
    top: calc( ( min( 100vw, 100vh ) / 6 ) + 6rem );
    width: 6rem;
    height: 3rem;
    border-radius: 1rem;
    background-color: var(--high);
    background-image: url('icon/check-black.png');
    background-size:contain;
    background-position:center;
    background-repeat:no-repeat;
    box-sizing: border-box;
}


#number-input-overlay .overlay-close-button:hover {
    border: 1px solid var(--white);
}
#number-input-overlay .overlay-close-button {
    border: 1px solid transparent;
    position:absolute;
    left:calc( 50vw - ( min( 100vw, 100vh ) / 6 ) );
    top: 1.5rem;
    width: 3rem;
    height: 3rem;
    border-radius: 1rem;
    background-image: url('icon/x.png');
    background-size:contain;
    background-position:center;
    background-repeat:no-repeat;
    box-sizing: border-box;
}
#number-input-overlay .overlay-number-input {
    position:absolute;
    left:calc( 50vw - ( min( 100vw, 100vh ) / 6 ) );
    top: 5rem;
    width: calc( min( 100vw, 100vh ) / 3 );
    height: 2rem;
    resize: none;
    box-sizing: border-box;
    margin:0;
    padding:1rem;
    border-radius: 1rem;
    border:1px solid black;
    background-color: var(--white);
    text-align: center;
}
#number-input-overlay .overlay-number-input:focus {
    outline:none;
    box-shadow: 0 0 1rem 0 var(--white);
}
#number-input-overlay .overlay-apply-button:hover {
    box-shadow: 0 0 1rem 0 var(--white);
}
#number-input-overlay .overlay-apply-button {
    position:absolute;
    left:calc( ( 50vw + ( min( 100vw, 100vh ) / 6 ) ) - 6rem );
    top: 8rem;
    width: 6rem;
    height: 3rem;
    border-radius: 1rem;
    background-color: var(--high);
    background-image: url('icon/check-black.png');
    background-size:contain;
    background-position:center;
    background-repeat:no-repeat;
    box-sizing: border-box;
}

#asset-browser-container {
    --asset-list-height: 100vh;
    --asset-list-width: 50vw;
    --asset-preview-width: 50vw;
    --asset-search-height: 3rem;
    --asset-layout-gap: 1rem;
    --asset-close-button-height: 3rem;
}
#asset-browser-container .overlay-close-button:hover {
    border: 1px solid var(--white);
}
#asset-browser-container .overlay-close-button {
    position:absolute;
    left: var(--asset-layout-gap);
    top: var(--asset-layout-gap);
    width: var(--asset-close-button-height);
    height: var(--asset-close-button-height);
    border-radius: 1rem;
    background-image: url('icon/x.png');
    background-size:2rem;
    background-position:center;
    background-repeat:no-repeat;
    border: 1px solid transparent;
}
#asset-browser-search-bar {
    position:absolute;
    width: calc( var(--asset-list-width) - ( var(--asset-layout-gap) * 1.5 ) );
    height: var(--asset-search-height);
    left: var(--asset-layout-gap);
    top: calc( ( var( --asset-layout-gap ) + var(--asset-close-button-height) ) + var(--asset-layout-gap) );
    background-color: var(--dark);
    border-radius: 1.5rem;
    border:1px solid var(--low-mid);
    box-sizing: border-box;
    box-shadow: 0 0 1rem 0 var(--very-dark);
    padding: 0 1rem;
}
#asset-browser-search-bar > img {
    position: absolute;
    height: 2rem;
    top: 0.5rem;
    right: 1rem;
}
#asset-browser-search-bar .placeholder {
    position: absolute;
    height: 2rem;
    top: 0.5rem;
    left: 1.5rem;
    opacity: 0.5;
    color: var(--white);
    font-size: 1rem;
    display: flex;
    flex-direction: row;
    justify-content: flex-start;
    align-items: center;
    line-height: 0;
}
#asset-browser-tags-bar {
    position:absolute;
    width: calc( 35vw - 1rem );
    height: 2rem;
    left: 10vw;
    top: calc( 5vh + 4rem );
    background-color: var(--dark);
    border-radius: 0.5rem;
    border:1px solid var(--low-mid);
    box-sizing: border-box;
    box-shadow: 0 0 1rem 0 var(--very-dark);
    padding: 0 1rem;
}
#asset-browser-tags-bar .placeholder {
    position: absolute;
    height: 2rem;
    top: 0;
    left: 1rem;
    opacity: 0.5;
    color: var(--white);
    font-size: 0.67rem;
    display: flex;
    flex-direction: row;
    justify-content: flex-start;
    align-items: center;
    line-height: 0;
}
#asset-browser-search-tags-bar {
    position:absolute;
    width: calc( 15vw - 1rem );
    height: 2rem;
    left: 45vw;
    top: calc( 5vh + 4rem );
    background-color: var(--dark);
    border-radius: 1.5rem;
    border:1px solid var(--low-mid);
    box-sizing: border-box;
    box-shadow: 0 0 1rem 0 var(--very-dark);
    padding: 0 1rem;
}
#asset-browser-search-tags-bar > img {
    position: absolute;
    height: 1rem;
    top: 0.5rem;
    right: 0.5rem;
}
#asset-browser-search-tags-bar .placeholder {
    position: absolute;
    height: 2rem;
    top: 0;
    left: 1rem;
    opacity: 0.5;
    color: var(--white);
    font-size: 0.67rem;
    display: flex;
    flex-direction: row;
    justify-content: flex-start;
    align-items: center;
    line-height: 0;
}
#asset-browser-list {
    position:absolute;
    width: calc( ( var(--asset-list-width) - var(--asset-layout-gap) ) - ( var(--asset-layout-gap) / 2.0 ) );
    --space-above: calc( (var(--asset-layout-gap) * 3) + ( var(--asset-search-height) + var(--asset-close-button-height) ) );
    height: calc( var(--asset-list-height) - ( var(--space-above) + var(--asset-layout-gap) ) );
    left: var(--asset-layout-gap);
    top: var(--space-above);
    background-color: var(--dark);
    border-radius: 1rem;
    border:1px solid var(--low-mid);
    box-sizing: border-box;
    box-shadow: 0 0 1rem 0 var(--very-dark);
    overflow-y: scroll;
    padding:0.5rem;
}
#asset-browser-list > .asset-element:hover {
    border: 1px solid var(--white);
}
#asset-browser-list > .asset-element.active {
    background-color: var(--low);
    border: 1px solid var(--white);
}
#asset-browser-list > .asset-element {
    background-color: var(--very-dark);
    border: 1px solid transparent;
    margin-bottom:0.5rem; padding:0;
    width:100%;
    min-height:1.5rem;
    font-size: 1rem;
    box-sizing: border-box;
    display: flex;
    flex-direction: row;
    justify-content: center;
    align-items: center;
    text-align: center;
    color:var(--white);
    border-radius: 0.5rem;
}
#asset-browser-preview {
    position:absolute;
    --space-below: calc( (var(--asset-layout-gap) * 2) + var(--asset-close-button-height) );
    width: calc( ( var(--asset-list-width) - var(--asset-layout-gap) ) - ( var(--asset-layout-gap) / 2.0 ) );
    height: calc( (var(--asset-list-height) - var(--space-below )) - var(--asset-layout-gap) );
    right: var(--asset-layout-gap);
    top: var(--asset-layout-gap);
    padding:1rem;
    background-color: var(--dark);
    border-radius: 1rem;
    border:1px solid var(--low-mid);
    box-sizing: border-box;
    box-shadow: 0 0 1rem 0 var(--very-dark);
    color: var(--white);
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    text-align: center;
    font-size: 1.67rem;
}
#asset-browser-apply-button:hover {
    box-shadow: 0 0 1rem 0 var(--white);
}
#asset-browser-apply-button {
    position:absolute;
    right: var(--asset-layout-gap);
    bottom: var(--asset-layout-gap);
    width: calc( var(--asset-close-button-height) * 2.0 );
    height: var(--asset-close-button-height);
    border-radius: 1rem;
    background-color: var(--high);
    background-image: url('icon/check-black.png');
    background-size:contain;
    background-position:center;
    background-repeat:no-repeat;
    box-sizing: border-box;
}

#console {
    display: none;
    box-sizing: border-box;
    position:absolute;
    left:calc( 80vw - 10px );
    top:calc( 80vh - 10px );
    width:20vw;
    height:10vh;
    border:1px solid red;
    font-size:14px;
    color:red;
    text-align: right;
    overflow: hidden;
    z-index: 1000000;
    pointer-events:none;
    white-space: pre-wrap;
}

.unimplemented, .unimplemented span, .unimplemented div, .unimplemented .tooltip {
    color: rgb(231, 206, 95) !important;
    /* text-decoration: line-through !important; */
}

#air-input {
    position: absolute;
    left: 0; top: 0;
    width: 1rem; height: 1rem;
    overflow: visible;
    --size: 100px;
}
#air-input > .ring::before {
    content: " ";
    position: absolute;
    left:calc( ( -0.3 * var(--size) ) - 0px );
    top:calc( ( -0.3 * var(--size) ) - 0px );
    width:calc( var(--size) + 0px );
    height:calc( var(--size) + 0px );
    border-radius: calc( 0.5 * ( var(--size) + 0px ) );
    border: 1px solid black;
    box-sizing: border-box;
}
#air-input > .ring::after {
    content: " ";
    position: absolute;
    left:0;
    top:0;
    --insize: calc( ( 0.4 * var(--size) ) + 2px );
    width:var(--insize);
    height:var(--insize);
    border-radius: calc( 0.5 * var(--insize) );
    border: 1px solid black;
    box-sizing: border-box;
}
#air-input > .ring {
    position: absolute;
    left:calc( -0.5 * var(--size) );
    top:calc( -0.5 * var(--size) );
    width:var(--size);
    height:var(--size);
    border-radius: calc( 0.5 * var(--size) );
    border: calc( 0.3 * var(--size)) solid rgba(255,255,255,0.5);
    box-sizing: border-box;
    background-color: transparent;
}

#cnv { pointer-events: none; }
#ui, #overlay {
    --very-dark:rgb(10,10,10);
    --dark:rgb(40,40,40);
    --low:rgb(60,60,60);
    --low-mid:rgb(80,80,80);
    --mid:rgb(120,120,120);
    --high-mid:rgb(180,180,180);
    --high:rgb(220,220,220);
    --white:rgb(240,240,240);
    pointer-events: none;
    user-select: none;
}

#home-row {
    position: absolute;
    left:0; top:0;
    padding: 0.5rem;
    height: 3.5rem;
    width:15rem;
    gap: 0.5rem;
    box-sizing: border-box;
    justify-content: flex-start;
    align-items: center;
    overflow: visible;
    z-index: 12000;
}
#home-row > div {
    position: relative;
    z-index: 13000;
}
.home-row-enter-fullscreen-button { background-image: url('icon/contract.png'); }
.home-row-enter-fullscreen-button.fullscreen { background-image: url('icon/expand.png'); }
.home-row-save-button { background-image: url('icon/save.png'); }
.home-row-load-button { background-image: url('icon/open.png'); }
.home-row-export-button { background-image: url('icon/export-image.png'); }

#tools-column {
    position: absolute;
    left:0; top:4.5rem; bottom:4.5rem;
    padding: 0.5rem;
    width:3.5rem;
    height: calc( 100vh - 9rem );
    gap: 0.5rem;
    box-sizing: border-box;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    overflow: visible;
}
.tools-column-generate-button { background-image: url('icon/magic.png'); }
.tools-column-paint-button { background-image: url('icon/brush.png'); }
.tools-column-mask-button { background-image: url('icon/mask.png'); }
.tools-column-transform-button { background-image: url('icon/move.png'); }
.tools-column-flood-fill-button { background-image: url('icon/paint-bucket.png'); }
.tools-column-text-tool-button { background-image: url('icon/text.png'); }
.tools-column-pose-button { background-image: url('icon/rig.png'); }

.round-toggle.unavailable { opacity: 0.25; }
.round-toggle.unavailable.hovering { border:1px solid transparent; }


#filters-controls-row.hidden {
    opacity: 0;
    transform: scale(0.9,0.9);
}
#filters-controls-row {
    top:0.5rem;
    position:absolute;
    left: 12.9rem;
    width:calc( 100vw - 19.5rem );
    z-index: 7000;
}

#generative-controls-row.hidden {
    opacity: 0;
    transform: scale(0.9,0.9);
}
#generative-controls-row {
    top:0.5rem;
    position:absolute;
    left: 12.9rem;
    width:calc( 100vw - 19.5rem );
    z-index: 7000;
}
#api-flow-selector-button {
    position: absolute;
    left:0; top:0;
    width:2.5rem;
    height:2.5rem;
    z-index: 11000;
}

#generative-controls-images-inputs-panel {
    position: absolute !important;
    right:10.2rem;
    top:-0.5rem;
    width:10rem; /* modify from js */
    position: relative;
    flex-shrink: 0;
    flex-grow: 0;
    display: block;
    padding: 0;
    margin: 0;
    text-align: center;
    box-sizing: border-box;
    z-index:10500;
}
.image-input-control:last-child {
    margin-right: 0;
}
.image-input-control .image-control-element-label {
    position: absolute;
    left:0; top:-1rem;
    height: 1rem;
    transform-origin: bottom left;
    transform: rotate( 90deg );
    width: 2.6rem;
    text-align: center;
    color: var(--white);
    font-size: 0.67rem;
    line-height: 0;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    text-wrap: nowrap;
    word-wrap: nowrap;
}
.image-input-control.drop-hovering {
    border:1px solid var(--white);
}
.image-input-control {
    border:1px solid transparent;
    position: relative;
    margin-right:0.5rem;
    width:1rem;
    height:3.5rem;
    background-color: var(--dark);
    box-shadow: 0 0 0.25rem 0 black;
    background-image: url('icon/picture.png');
    background-position: bottom center;
    background-size: contain;
    background-repeat: no-repeat;
    display: inline-block;
    border-bottom-left-radius: 0.5rem;
    border-bottom-right-radius: 0.5rem;
}

#generative-controls-panel {
    position: absolute;
    left:2.5rem; top:0;
    width:calc( 100% - 12.9rem );/* modify from js */
    position: relative;
    flex-shrink: 0;
    flex-grow: 0;
    display: flex;
    flex-direction: row;
    justify-content: stretch;
    align-items: flex-start;
    padding: 0 0.5rem; margin: 0;
    box-sizing: border-box;
    gap:0.5rem;
    flex-wrap: wrap;
    z-index:10000;
}
#generate-button .generate-label { transform: scale(1,1); }
#generate-button.pushed .generate-label { transform: scale(0.9,0.9); }
#generate-button {
    flex-shrink: 0;
    background-color: var(--white);
    color: var(--dark);
    font-size: 1.167rem;
    letter-spacing: 1px;
    border-radius: 1rem;
    line-height: 0;
    text-align: center;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    position:absolute;
    right:0; top:0;
    width:9.9rem;
    height:2.5rem;
    box-sizing: border-box;
    padding:0; margin:0;;
    /* font-family: Georgia, 'Times New Roman', Times, serif; */
}
#generative-controls-panel div.hidden {
    display: none;
}
#generative-controls-panel .text-input-control-text {
    width:100%;
    height:2.5rem;
    box-sizing: border-box;
    white-space:nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    line-height: 2.5rem;
}
.control-element-label {
    position: absolute;
    left:-0.33rem; top:-0.33rem;
    max-width: 100%;
    color:var(--white);
    background-color: var(--dark);
    box-shadow:
        0 0 0.5rem 0 var(--dark),
        0 0 0.25rem 0 var(--dark),
        0 0 0.125rem 0 var(--dark)
        ;
    height:1rem;
    line-height: 1rem;
    padding: 0 0.5rem;
    box-sizing: border-box;
    font-size: 0.67rem;
    border-radius: 0.5rem;
    white-space: nowrap;
    text-wrap: nowrap;
    word-wrap: nowrap;
    text-overflow: hidden;
    text-align: left;
    text-overflow: ellipsis;
}
#generative-controls-panel .text-input-control {
    position: relative;
    flex-grow:1;
    min-width:10rem;
    height:2.5rem;
    background-color: var(--mid);
    border:1px solid var(--high-mid);
    box-sizing: border-box;
    border-radius: 1rem;
    font-stretch: condensed;
    letter-spacing: -1px;
    padding:0.5rem 0.67rem;
    line-height: 0;
    display: flex;
    flex-direction: row;
    justify-content: flex-start;
    align-items: center;
    color: var(--very-dark);
    flex-basis: 48%;
    z-index: 9000;
}
.generative-controls-retractable-slider-left-arrow { background-image: url('icon/arrow-left.png'); }
.generative-controls-retractable-slider-right-arrow { background-image: url('icon/arrow-right.png'); }
.generative-controls-retractable-slider-left-arrow,
.generative-controls-retractable-slider-right-arrow {
    flex-grow: 0;
    width:1rem;
    height:2.5rem;
    background-repeat: no-repeat;
    background-size: contain;
    background-position: center;
}
.generative-controls-retractable-slider-number-preview {
    flex-grow: 1;
}
.generative-controls-retractable-slider {
    position: relative;
    flex-grow: 0;
    width:5rem;
    height:2.5rem;
    background-color: var(--mid);
    border:1px solid var(--high-mid);
    box-sizing: border-box;
    border-radius: 1rem;
    line-height: 0;
    display: flex;
    flex-direction: row;
    justify-content: center;
    align-items: center;
    text-align: center;
    color: var(--very-dark);
    z-index: 8000;
}

#transform-tools-options-row.hidden {
    opacity: 0;
    transform: scale(0.9,0.9);
}
#transform-tools-options-row > div {
    position: relative;
    z-index: 6000;
}
#transform-tools-options-row {
    position:absolute;
    left: 12.9rem;
    width:calc( 100vw - 19.5rem );
    height:3.5rem;
    justify-content: center;
    align-items: center;
    gap:0.5rem;
    z-index: 5000;
}
#transform-tools-options-row > div.hidden.animated {
    transition:
        opacity var(--animation-speed),
        transform var(--animation-speed),
        background-color var(--animation-speed),
        border-color var(--animation-speed),
        filter var(--animation-speed),
        background-size var(--animation-speed),
        top var(--animation-speed),
        width 0s var(--animation-speed),
        height 0s var(--animation-speed);
    
}
#transform-tools-options-row > div.hidden {
    width:1px;
    height:1px;
    transform: scale( 0.1, 0.1 );
    opacity: 0;
}

#pose-rig-container {
    position: absolute;
    left: 0; top:0;
    width: 100vw;
    height: 100vh;
}
#pose-rig-container > .pose-rig-handle {
    position: absolute;
    width: 1rem; height: 1rem;
    border-radius: 0.5rem;
    border:1px solid white;
    box-shadow: 0 0 1rem 1px black;
    box-sizing: border-box;

    /* Properties set from JS */
    left: 0; top:0;
    background-color: red;
}

#flood-fill-tools-options-row.hidden {
    opacity: 0;
    transform: scale(0.9,0.9);
}
#flood-fill-tools-options-row > div {
    position: relative;
    z-index: 6000;
}
#flood-fill-tools-options-row {
    position:absolute;
    left: 12.9rem;
    width:calc( 100vw - 19.5rem );
    height:3.5rem;
    justify-content: center;
    align-items: center;
    gap:0.5rem;
    z-index: 5000;
}
.flood-fill-options-erase-toggle { background-image: url('icon/eraser.png'); }
.flood-fill-options-color-toggle { background-image: url('icon/three-circles.png'); }

#pose-tools-options-row.hidden {
    opacity: 0;
    transform: scale(0.9,0.9);
}
#pose-tools-options-row > div {
    position: relative;
    z-index: 6000;
}
#pose-tools-options-row {
    position:absolute;
    left: 12.9rem;
    width:calc( 100vw - 19.5rem );
    height:3.5rem;
    justify-content: center;
    align-items: center;
    gap:0.5rem;
    z-index: 5000;
}
.pose-tools-options-move-children-toggle { background-image: url('icon/move.png'); }

#paint-tools-options-row.hidden {
    opacity: 0;
    transform: scale(0.9,0.9);
}
#paint-tools-options-row > div {
    position: relative;
    z-index: 6000;
}
#paint-tools-options-row {
    position:absolute;
    left: 12.9rem;
    width:calc( 100vw - 27.9rem );
    height:3.5rem;
    justify-content: center;
    align-items: center;
    gap:0.5rem;
    z-index: 5000;
}
.paint-tools-options-paint-mode { background-image: url('icon/brush.png'); }
.paint-tools-options-blend-mode { background-image: url('icon/blend.png'); }
.paint-tools-options-erase-mode { background-image: url('icon/eraser.png'); }
.paint-tools-options-retractable-slider.hovering {
    border: 1px solid white;;
}
.paint-tools-options-retractable-slider {
    height:2.5rem;
    width:2.5rem;
    flex-grow: 0;
    border-radius: 1.25rem;
    background-color: var(--mid);
    border: 1px solid transparent;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
}
.paint-tools-options-retractable-opacity-slider {
    background-image: url('icon/opacity-grid.png');
    background-size: cover;
    background-position: center;
    background-repeat: repeat;
}
.paint-tools-options-preview-number {
    position:absolute;
    left:calc( 50% - 1.25rem );
    width:2.5rem;
    height: 1rem;
    text-align: center;
    overflow: visible;
    top:calc( 100% + 0.5rem );
    color: white;
    font-size: 1rem;
    text-shadow:
        0 0 0.125rem black,
        0 0 0.25rem black,
        0 0 0.5rem black;
}
.paint-tools-options-brush-size-preview-core {
    border:2px solid var(--very-dark);
    border-radius: 50%;
    box-sizing: border-box;
    width:50%;
    height:50%;
}
.paint-tools-options-brush-softness-preview-core {
    background-color: var(--very-dark);
    border-radius: 50%;
    box-sizing: border-box;
    width:50%;
    height:50%;
    filter: blur(0.1rem);
}
.paint-tools-options-brush-opacity-preview-core {
    background-color: rgb(128,128,128);
    border-radius: 50%;
    box-sizing: border-box;
    width:67%;
    height:67%;
    opacity: 0.5;
}
.paint-tools-options-color-well.hidden {
    opacity: 0;
    transform: scale(0.9,0.9);
}
.paint-tools-options-color-well {
    height:2.5rem;
    width:2.5rem;
    flex-grow: 0;
    border-radius: 1.25rem;
    background-color: var(--mid);
    border: 1px solid var(--very-dark);
}

.color-wheel.hidden {
    opacity: 0;
    transform: scale(0.9,0.9);
}
.color-wheel {
    position:absolute;
    background-color: transparent;
    --size:256px;
    left:0; top:0;
    width:var(--size);
    height:var(--size);
    overflow: hidden;
    z-index: 1000000;
}
.color-wheel > div.base-color {
    position:absolute;
    width:var(--size); height:var(--size);
    left: 0; top: 0;
    background-color: red;
    border-radius: 1rem;
}
.color-wheel > img.upper-slot {
    position:absolute;
    width:var(--size); height:calc( var(--size) / 2 );
    left: 0; top: 0;
    mix-blend-mode: saturation;
    opacity: 1;
}
.color-wheel > img.lower-slot {
    position:absolute;
    width:var(--size); height:calc( var(--size) / 2 );
    left: 0; top: calc( var(--size) / 2 );
    mix-blend-mode: luminosity;
}
.color-wheel > img.base {
    position:absolute;
    width:var(--size); height:var(--size);
    left: 0; top: 0;
    border-radius: 1rem;
}
.color-wheel > .color-preview {
    position:absolute;
    width:calc( var(--size) / 3 ); height:calc( var(--size) / 3 );
    left: calc(  var(--size) / 3 );
    top: calc(  var(--size) / 3 );
    border-radius: calc( var(--size) / 6 );
    box-shadow: 0 0 2px 2px black;
    background-color: red;
    box-sizing: border-box;
}
.color-wheel > div.nubs-overlay {
    position:absolute;
    width:var(--size); height:var(--size);
    left: 0;
    top: 0;
}
.nubs-overlay > .color-nub {
    position:absolute;
    left:0; top:0;
    width:calc( var(--size)*0.05 );
    height:calc( var(--size)*0.05 );
    border-radius:calc( var(--size)*0.025 );
    background-color: white;
    box-shadow: 0 0 2px 2px black;
}

.flex-row {
    display: flex;
    flex-direction: row;
    justify-content: center;
    align-items: center;
}

#layers-above-row {
    position: absolute;
    right: 0; top: 0;
    padding: 0.5rem;
    height: 3.5rem;
    width: 10rem;
    gap: 0.5rem;
    box-sizing: border-box;
    justify-content: flex-end;
    overflow: visible;
    z-index: 20000;
}

.animated {
    transition:
        opacity var(--animation-speed),
        transform var(--animation-speed),
        background-color var(--animation-speed),
        border-color var(--animation-speed),
        filter var(--animation-speed),
        background-size var(--animation-speed),
        top var(--animation-speed);
}

.tooltip-holder {
    position: relative;
    overflow: visible;
}
.tooltip-holder.hovering > .tooltip {
    opacity: 1;
}
.tooltip-holder > .tooltip > img {
    height: 0.67rem;
}
.tooltip-holder > .tooltip {
    height: 1.5rem;
    font-size: 0.67rem;
    line-height: 1rem;
    background-color: var(--very-dark);
    border:1px solid white;
    box-sizing: border-box;
    position:absolute;
    padding: 0.25rem;
    white-space: nowrap;
    max-width: 50vw;
    overflow: hidden;
    text-overflow: ellipsis;
    color: var(--white);
    opacity: 0;
    z-index: 10000000;
    display: flex;
    flex-direction: row;
    justify-content: center;
    align-items: center;
}
.tooltip.below { top: calc( 100% + 0.5rem ); }
.tooltip.above { bottom: calc( 100% + 0.5rem ); }
.tooltip.to-left { right: calc( 100% + 0.5rem ); }
.tooltip.to-right { left: calc( 100% + 0.5rem ); }
.tooltip.to-left-of-center { right: 50%; }
.tooltip.to-right-of-center { left: 50%; }
.tooltip.below-center { top: 50%; }
.tooltip.above-center { bottom: 50%; }
.tooltip.vertical-center { top: calc( 50% - 0.75rem ); }
/* .tooltip.horizontal-center {} */

#show-layers-button {
    background-image: url('icon/layers.png');
}

.round-toggle.long > div.button-text {
    height: 1.67rem;
    width:100%;
    line-height: 1.67rem;
    white-space: nowrap;
    box-sizing: border-box;
    overflow: hidden;
    text-overflow: ellipsis;
}
.round-toggle.long {
    position: relative;
    flex-grow:1;
    width: auto;
    min-width:10rem;
    font-stretch: condensed;
    letter-spacing: -1px;
    padding:0.5rem 0.67rem;
    line-height: 0;
    display: flex;
    flex-direction: row;
    justify-content: flex-start;
    align-items: center;
    color: var(--white);
    flex-basis: 15%;
    z-index: 8000;
}
.round-toggle .control-element-label {
    color:var(--dark);
    background-color: var(--high-mid);
    box-shadow:
        0 0 0.5rem 0 var(--white),
        0 0 0.25rem 0 var(--white),
        0 0 0.125rem 0 var(--white)
        ;
}
.round-toggle {
    position: relative;
    flex-grow: 0;
    flex-shrink: 0;
    height:2.5rem;
    width:2.5rem;
    flex-grow: 0;
    border-radius: 1rem;
    background-color: transparent;
    background-size: 1.5rem;
    background-position: center;
    background-repeat: no-repeat;
    opacity: 1;
    transform: scale(1,1);
    border: 1px solid transparent;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    line-height: 0;
    color: var(--white);
    box-sizing: border-box;
    z-index: 8000;
}
.round-toggle.on {
    background-color: var(--dark);
}
.round-toggle.hidden {
    opacity: 0;
    transform: scale(0.67,0.67);
}
.round-toggle.hovering {
    border-color: var(--white);
}
.round-toggle.pushed {
    background-size: 1.35rem;
}
#add-layer-button {
    background-image: url('icon/add.png');
    overflow: visible;
    position: relative;
    z-index: 21000;
}

#add-layers-panel {
    position: absolute;
    right: calc( 50% - 0.707rem );
    top: calc( 100% + 1rem );
    width: 17rem;
    height:18.5rem;
    background-color: var(--dark);
    overflow: visible;
    border-radius: 1rem;
    border-top-right-radius: 0;
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    align-items: stretch;
    padding: 0.5rem;
    box-sizing: border-box;
    gap:0.5rem;
    z-index: 22000;
    box-shadow: 0 0 1rem 1px black;
}
#add-layers-panel > .summon-marker {
    position: absolute;
    right:0; top:0;
    width:1rem; height:1rem;
    transform-origin: top right;
    transform: rotate( 45deg );
    background-color:  var(--dark);
}
#add-layers-panel.hidden {
    opacity: 0;
    transform: scale(0.9,0.9) translate( 5%, -10% );
}
#add-layers-panel > .spacer {
    flex-grow: 0;
    flex-shrink: 0;
    width:100%;
    height:2px;
    background-color: var(--low-mid);
}

.rounded-line-button {
    flex-grow: 1;
    height: 2rem;
    border-radius: 1rem;
    width:100%;
    padding: 0.25rem;
    display: flex;
    flex-direction: row;
    justify-content: stretch;
    align-items: center;
    text-align: center;
    background-color: transparent;
    box-sizing: border-box;
}
.rounded-line-button > span {
    flex-grow: 1;
    text-align: center;
    color: var(--white);
}
.rounded-line-button > img {
    flex-grow: 0;
    height: 1.5rem;
    margin: 0 0.5rem;
}
.rounded-line-button.hovering {
    background-color: var(--low-mid);
}
.rounded-line-button.pushed {
    transform: scale(0.9,0.9);
}

#layers-column {
    position: absolute;
    right:0; top:0rem;
    width:15rem;
    box-sizing: border-box;
    height: 4rem;
    pointer-events: none !important;
    overflow: visible;
    padding:0; margin: 0;
    z-index: 100;
}
#layers-column.hidden {
    opacity: 0;
    transform: translate( 0, -1rem );
}

.layer-button.hovering {
    border: 1px solid rgba(255,255,255,0.5);
}
#layers-column > .layer-button.active {
    box-shadow: 0 0 0.5rem 0 rgba(0,0,0,0.5);
    border:1px solid var(--white);
}

.layer-group-joiner {
    display: none;
}
.layer-button.layer-in-group > .layer-group-joiner {
    display: block;
    position: absolute;
    left: 0.5rem;
    top: -0.5rem;
    width: 1px;
    height: 0.5rem;
    background-color: var(--white);
}
.layer-button {
    --layerWidth: 14rem;
    --margin-left: 0.5rem;
}
.layer-button.layer-in-group { --layerWidth: 13.5rem; --margin-left: 1.0rem; }
.layer-button.layer-in-group.layer-group-depth-2 { --layerWidth: 13.0rem; --margin-left: 1.5rem; }
.layer-button.layer-in-group.layer-group-depth-3 { --layerWidth: 12.5rem; --margin-left: 2.0rem; }
.layer-button.layer-in-group.layer-group-depth-4 { --layerWidth: 12.0rem; --margin-left: 2.5rem; }
.layer-button.layer-in-group.layer-group-depth-5 { --layerWidth: 11.5rem; --margin-left: 3.0rem; }
.layer-button {
    position: relative;
    width:var(--layerWidth);
    /* width:14rem; */
    height:4rem;
    border:1px solid transparent;
    background-color: var(--dark);
    margin:0.5rem;
    margin-left: var(--margin-left);
    border-radius: 0.5rem;
    box-sizing: border-box;
    display: flex;
    flex-direction: row;
    justify-content: flex-start;
    align-items: center;
    padding: 0.25rem;
    gap: 0.25rem;
    z-index: 110;
}
.layer-button.active > .layer-name { background-color: var(--low); }
.layer-name .layer-name-text {
    display: block;
    position: relative;
    width:100%;
    text-align: center;
    overflow: hidden;
    text-overflow: ellipsis;
    padding: 0 1rem;
    white-space: nowrap;
}
.layer-name.hovering { border:1px solid var(--white);}
.layer-name {
    text-shadow:
        0 0 0.125rem black,
        0 0 0.25rem black,
        0 0 0.5rem black;
    border-radius: 0.5rem;
    border:1px solid transparent;
    position:absolute;
    left:3.5rem; top:0.375rem;
    height:1rem; width:calc( 100% - 5.5rem );
    box-sizing: border-box;
    display: flex;
    flex-direction: row;
    flex-wrap: nowrap;
    white-space: nowrap;
    justify-content: center;
    align-items: center;
    text-align: center;
    color: var(--white);
    font-size: 10px;
}
.layer-button > canvas {
    max-height: 3.5rem;
    max-width: 3.5rem;
    box-shadow: 0 0 1rem 0 black;
}

.layer-button .layer-type-icon {
    height: 1rem;
    width: 1rem;
    background-position: center;
    background-size: contain;
    background-repeat: no-repeat;
    position: absolute;
    left:-1.5rem;
    top:0;
}
.layer-button .layer-type-icon.paint {  background-image: url('icon/brush.png'); }
.layer-button .layer-type-icon.generative {  background-image: url('icon/magic.png'); }
.layer-button .layer-type-icon.text {  background-image: url('icon/text.png'); }
.layer-button .layer-type-icon.pose {  background-image: url('icon/rig.png'); }
.layer-button .layer-type-icon.group {  background-image: url('icon/folder.png'); }
.layer-button .layer-type-icon.group.open { background-image: url('icon/open-folder.png'); }

.layer-button.hover-drop-above > .layer-upper-dropzone { opacity: 1; transform: scale( 1,1 ); }
.layer-button.hover-drop-below > .layer-lower-dropzone { opacity: 1; transform: scale( 1,1 ); }
.layer-button.layer-in-group.hover-drop-below > .layer-lower-dropzone-group-joiner { opacity: 1; }
.layer-lower-dropzone { bottom: -0.33rem; }
.layer-upper-dropzone { top: -0.33rem; }
.layer-upper-dropzone, .layer-lower-dropzone {
    position: absolute;
    left: 0.5rem;
    width: calc( 100% - 1rem );
    height: 1px;
    border-radius: 1px;
    box-shadow: 0 0 0.25rem 0 var(--white);
    opacity: 0;
    transform: scale( 0.9,1 );
    background-color: var(--white);
}
.layer-lower-dropzone-group-joiner {
    position: absolute;
    left: 0.5rem;
    bottom: -0.33rem;
    width: 1px;
    height: 0.33rem;
    border-radius: 1px;
    box-shadow: 0 0 0.25rem 0 var(--white);
    opacity: 0;
    background-color: var(--white);
}
.layer-ui-button.hidden, .layer-opacity-slider.hidden {
    opacity: 0;
    transform: scale(0.9,0.9);
}
.layer-ui-button.hovering {
    border:1px solid white;
}
.layer-ui-button {
    position: absolute;
    width:1rem; height:1rem;
    border-radius: 0.25rem;
    background-repeat: no-repeat;
    background-size: 1rem;
    background-position: center;
    border: 1px solid transparent;
}
.layer-visibility-button {
    left: 0.5rem; top: 0.25rem;
    background-color: var(--low-mid);
    background-image: url('icon/eye.png');
}
.layer-visibility-button.off {
    background-color: transparent;
    background-image: url('icon/eye-x.png');
}
.layer-duplicate-button {
    left: 2rem; top: 0.25rem;
    background-image: url('icon/duplicate-layer.png');
}
.layer-delete-button {
    right: 0.5rem; top: 0.25rem;
    background-image: url('icon/trash.png');
}
.layer-merge-button {
    right: 0.5rem; bottom: 0.25rem;
    background-image: url('icon/merge-layer-down.png');
}
.layer-convert-to-paint-button {
    right: 0.5rem; bottom: 0.25rem;
    background-image: url('icon/to-paint.png');
}
.layer-move-button {
    left: 0.5rem; bottom: 0.25rem;
    background-image: url('icon/move.png');
}
.layer-opacity-slider {
    position: absolute !important;
    left:2rem;
    right:2rem;
    bottom:0.5rem;
}
.layer-node-link-source.hovering {
    background-color: var(--low);
}
.layer-button.active > .layer-node-link-source {
    box-shadow: 0 0 0.5rem 0 rgba(0,0,0,0.5);
    border: 1px solid white;
    border-right: 0;
}
.layer-node-link-source.hidden {
    opacity: 0;
    transform: scale(0.9,0.9);
}
.layer-node-link-source {
    border: 1px solid transparent;
    border-right: 0;
    box-sizing: border-box;
    position: absolute;
    left:calc( -2rem - 1px );
    top:calc(50%-0.75rem);
    width:2rem;
    height:1.5rem;
    background-color: var(--dark);
    background-image: url('icon/picture.png');
    background-repeat: no-repeat;
    background-size: 1rem;
    background-position: center;
    border-top-left-radius: 0.5rem;
    border-bottom-left-radius: 0.5rem;
}
.layer-node-tail.hidden {
    opacity: 0;
}
.layer-node-tail.faded {
    border-left: 2px dashed white;
}
.layer-node-tail {
    position: absolute;
    bottom: 50%;
    right: 100%;
    width:5rem;
    height:10rem;
    border-bottom-left-radius:1rem;
    border-bottom: 2px solid white;
    border-left: 2px solid white;
    border-top: 0; border-right: 0;
}

.slider {
    position: relative;
    background-color: var(--low-mid);
    border: 1px solid var(--dark);
    box-sizing: border-box;
    border-radius:0.25rem;
    height:0.5rem;
}
.slider > .nub {
    position: absolute;
    left:50%;
    top:0;
    height:0.5rem;
    width:0.5rem;
    border-radius: 0.25rem;
    background-color: var(--white);
    margin-left:-0.5rem;
}


.number-slider-left-arrow { background-image: url('icon/arrow-left.png'); }
.number-slider-right-arrow { background-image: url('icon/arrow-right.png'); }
.number-slider-left-arrow,
.number-slider-right-arrow {
    flex-grow: 0;
    width:1rem;
    height:2.5rem;
    background-repeat: no-repeat;
    background-size: contain;
    background-position: center;
}
.number-slider-number-preview {
    flex-grow: 1;
}
.number-slider {
    position: relative;
    flex-grow: 0;
    width:5rem;
    height:2.5rem;
    background-color: var(--mid);
    border:1px solid var(--high-mid);
    box-sizing: border-box;
    border-radius: 1rem;
    line-height: 0;
    display: flex;
    flex-direction: row;
    justify-content: center;
    align-items: center;
    text-align: center;
    color: var(--very-dark);
    z-index: 8000;
}
.number-slider-label {
    position: absolute;
    left:-0.33rem; top:-0.33rem;
    background-color: var(--dark);
    box-shadow:
        0 0 0.5rem 0 var(--dark),
        0 0 0.25rem 0 var(--dark),
        0 0 0.125rem 0 var(--dark)
        ;
    height:1rem;
    line-height: 1rem;
    max-width: 100%;
    overflow: hidden;
    padding: 0 0.5rem;
    box-sizing: border-box;
    font-size: 0.67rem;
    white-space: nowrap;
    color:var(--white);
    border-radius: 0.5rem;
    text-overflow: ellipsis;
    text-align: left;
}

#undo-redo-row {
    position: absolute;
    left:0rem; bottom:0rem;
    padding:0.5rem;
    box-sizing: border-box;
    height:3.5rem;
    width:6.5rem;
    gap:0.5rem;
}
#undo-button { background-image: url('icon/undo.png'); }
#redo-button { background-image: url('icon/redo.png'); }

        </style>
    </head>
    <body>

        <script type="text/javascript">
            const scr = document.body.appendChild( document.createElement( "script" ) );
            scr.src = "canvas.js?v=" + parseInt( 100000000 * Math.random() );
        </script>

    </body>
</html>