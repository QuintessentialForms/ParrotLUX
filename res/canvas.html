<!DOCTYPE HTML>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, touch-action=none, interactive-widget=resizes-content" />
        <title>AI Canvas</title>
        <link rel="stylesheet" type="text/css" href="canvas.css" />
        <script type="text/javascript" src="store.js"></script>
        <style>
/* We have this inlined during dev b/c the stylesheet won't refresh on tablet. :-/ */
body {
    overflow: hidden;
    overscroll-behavior: none;
    touch-action: none;
    height:100%;
    height:100vh;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    user-select: none;
    --animation-speed: 0.2s; /* also set in JS, as UI.animationMS */
}
#main {
    background-color: rgb(64,64,64);
}
#main, #cnv, #ui, #node-drag-overlay, #gnv, #underlay {
    position: absolute;
    left:0; top:0; right:0; bottom:0;
    width:100vw; height:100vh;
    user-select: none;
}
#gnv {
    pointer-events: all;
}

#cnv { pointer-events: none; }
#ui, #overlay {
    --very-dark:rgb(10,10,10);
    --dark:rgb(40,40,40);
    --low:rgb(60,60,60);
    --low-mid:rgb(80,80,80);
    --mid:rgb(120,120,120);
    --high-mid:rgb(180,180,180);
    --high:rgb(220,220,220);
    --white:rgb(240,240,240);
    pointer-events: none;
    user-select: none;
    --button-size:2rem;
    --button-gap:0.25rem;
    --file-row-width:calc( var(--button-gap) + ( 3 * ( var(--button-size) + var(--button-gap)  ) ) );
    --layers-row-width:calc( var(--button-gap) + ( 2 * ( var(--button-size) + var(--button-gap) ) ) );
    --generate-button-width:9.9rem; /* maybe modified in media rule later */
}

#underlay > .hidden {
    opacity: 0;
}

#overlay {
    z-index: 10000000;
}
#overlay > .real-input.hidden {
    pointer-events: none;
    opacity: 0;
}
#overlay .hidden .overlay-element {
    opacity: 0;
    transform: scale(0.9,0.9)
}
.overlay-element.pushed {
    transform: scale(0.9,0.9);
}
#overlay > .real-input {
    pointer-events: all;
}
#overlay > .overlay-background {
    position: absolute;
    left: 0; top: 0;
    width:100vw; height:100vh;
    background-color: rgba(0,0,0,0.75);
    z-index: 10001000;
}

.overlay-background.hidden > #generating-canvas {
    filter:blur(20px);
    transform: scale(0.9,0.9);
    opacity: 0;
}
#generating-canvas {
    position:absolute;
    left:calc( 50vw - ( min( 100vw, 100vh ) / 6 ) );
    top: 5rem;
    width: calc( min( 100vw, 100vh ) / 3 );
    height: calc( min( 100vw, 100vh ) / 3 );
    box-sizing: border-box;
    margin:0;
}

#error-notification-overlay .overlay-close-button:hover,
#multiline-text-input-overlay .overlay-close-button:hover,
#number-input-overlay .overlay-close-button:hover,
#filename-input-overlay .overlay-close-button:hover
 {
    border: 1px solid var(--white);
}
#error-notification-overlay .overlay-close-button,
#multiline-text-input-overlay .overlay-close-button,
#number-input-overlay .overlay-close-button,
#filename-input-overlay .overlay-close-button
 {
    border: 1px solid transparent;
    position:absolute;
    left:calc( 50vw - ( min( 100vw, 100vh ) / 6 ) );
    top: 1.5rem;
    width: 3rem;
    height: 3rem;
    border-radius: 1rem;
    background-image: url('icon/x.png');
    background-size:contain;
    background-position:center;
    background-repeat:no-repeat;
    box-sizing: border-box;
}
#error-notification-overlay .overlay-input-label,
#multiline-text-input-overlay .overlay-input-label,
#number-input-overlay .overlay-input-label,
#filename-input-overlay .overlay-input-label {
    border: 0;
    position:absolute;
    right:calc( 50vw - ( min( 100vw, 100vh ) / 6 ) );
    top: 1.5rem;
    width: calc( ( 50vw - ( min( 100vw, 100vh ) / 3 ) ) - 4rem );
    height: 3rem;
    border-radius: 1rem;
    box-sizing: border-box;
    text-align: right;
    font-size: 1.33rem;
    color:var(--white);
    line-height: 3rem;
    pointer-events: none;
}



#error-notification-overlay .overlay-error-notification {
    position:absolute;
    left:calc( 50vw - ( min( 100vw, 100vh ) / 6 ) );
    top: 5rem;
    width: calc( min( 100vw, 100vh ) / 3 );
    height: calc( min( 100vw, 100vh ) / 6 );
    resize: none;
    box-sizing: border-box;
    margin:0;
    padding:1rem;
    border-radius: 1rem;
    border:1px solid var(--mid);
    color: var(--white);
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    align-items: center;
    text-align: center;
    overflow-y: scroll;
}
#error-notification-overlay .overlay-accept-button:hover {
    box-shadow: 0 0 1rem 0 var(--white);
}
#error-notification-overlay .overlay-accept-button {
    position:absolute;
    left:calc( ( 50vw + ( min( 100vw, 100vh ) / 6 ) ) - 6rem );
    top: calc( ( min( 100vw, 100vh ) / 6 ) + 6rem );
    width: 6rem;
    height: 3rem;
    border-radius: 1rem;
    background-color: var(--high);
    background-image: url('icon/check-black.png');
    background-size:contain;
    background-position:center;
    background-repeat:no-repeat;
    box-sizing: border-box;
}

#settings-controlpanel-overlay {
    --width: max(30rem,50vw);
}
#settings-controlpanel-overlay .overlay-close-button:hover {
    border: 1px solid var(--white);
}
#settings-controlpanel-overlay .overlay-close-button {
    border: 1px solid transparent;
    position:absolute;
    left:max( 0rem, calc( (50vw - ( var(--width) / 2.0 )) - 4rem ) );
    top: 2.5vw;
    width: 3rem;
    height: 3rem;
    border-radius: 1rem;
    background-image: url('icon/x.png');
    background-size:contain;
    background-position:center;
    background-repeat:no-repeat;
    box-sizing: border-box;
}
#settings-controlpanel-overlay .overlay-controlpanel {
    position:absolute;
    left:max( 4rem, calc( 50vw - ( var(--width) / 2.0 ) ) );
    top: 2.5vw;
    width: var(--width);
    min-width: 25rem;
    height: calc( 100vh - 5vw );
    resize: none;
    box-sizing: border-box;
    margin:0;
    padding:1rem;
    border-radius: 1rem;
    border:1px solid var(--mid);
    background-color: var(--dark);
}

.overlay-controlpanel-label {
    height:3rem;
    font-size:1.67rem;
    color:var(--white);
    margin:1rem;
    margin-top:1.67rem;
    margin-bottom:1.2rem;
    border-bottom: 1px solid var(--white);
}
.apikeys-panel::after {
    opacity: 0;
    transition: opacity var(--animation-speed);
    pointer-events: none;

    content: "Click to Show";
    position: absolute;
    left:0; top:0; right:0; bottom:0;
    border-radius:0.5rem;
    filter:none;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    text-align: center;
    background-color: rgba(0,0,0,0.125);
    color:var(--white);
    font-size: 1.67rem;
    text-shadow:
        0 0 0.125rem black,
        0 0 0.125rem black,
        0 0 0.25rem black,
        0 0 0.25rem black,
        0 0 0.5rem black,
        0 0 0.5rem black
    ;
    box-shadow:
        0 0 1rem 0 rgba(128,128,128,0.5) inset,
        0 0 2rem 0 rgba(128,128,128,0.5) inset,
        0 0 4rem 0 rgba(128,128,128,0.5) inset
    ;
}
.apikeys-panel.blur:hover::after {
    border: 1px solid var(--white);
}
.apikeys-panel.blur::after {
    opacity: 1;
    pointer-events: all;
}
.apikeys-panel {
    position:relative;
    width:auto;
    margin:1rem;
    padding-top:0.5rem;
    border-radius:0.5rem;
    border:1px solid var(--high-mid);
    background-color: transparent;
}
.apikeys-panel .apikey-row, .apikeys-panel .apikey-row-button {
    transition: filter var(--animation-speed);
}
.apikeys-panel.blur .apikey-row, .apikeys-panel.blur .apikey-row-button {
    filter:blur(4px);
}
.apikeys-panel .apikey-row {
    width:auto;
    display: flex;
    flex-direction: row;
    justify-content: stretch;
    align-items: stretch;
    box-sizing: content-box;
    height:1.75rem;
    margin:0.25rem;
    margin-bottom:0.67rem;
    padding:0.25rem;
    gap:0;
}
.apikey-row-button:first-child {
    border-top-left-radius:0.25rem;
    border-bottom-left-radius:0.25rem;
}
.apikey-row-button:last-child {
    border-top-right-radius:0.25rem;
    border-bottom-right-radius:0.25rem;
}
.apikey-row-button:hover, .apikey-row-button.dark:hover { border:1px solid var(--white); }
.apikey-row-button.dark {
    border:1px solid var(--mid);
    background-color: var(--dark);
    color: var(--white);
    text-align: center;
}
.apikey-row-delete-icon.stub.dark:hover {
    background-color: rgb(200, 88, 88);
}
.apikey-row-delete-icon {
    background-image: url('icon/trash.png');
    background-position: center;
    background-size: contain;
    background-repeat: no-repeat;
}
.apikey-row-button.stub {
    width:1.75rem;
    flex-grow: 0;
    flex-basis: 1.75rem;
}
.apikey-row-button.long {
    flex-basis: 100%;
    border: 1px dashed var(--mid);
    border-radius: 0.25rem;
}
.apikey-row-button {
    flex-grow: 1;
    flex-basis: 33%;
    border: 1px solid var(--mid);
    background-color: var(--high-mid);
    color:var(--dark);
    border-radius:0;
    padding:0.25rem;
    line-height: 1rem;
    box-sizing: border-box;
    white-space:nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}


#multiline-text-input-overlay {
    --text-input-width: min( max( calc( min(100vw,100vh) / 3 ), 20rem ), calc( 100vw - 1rem ) );
    --text-input-height: min( 50vh, 5rem );
}
#multiline-text-input-overlay .overlay-text-input {
    position:absolute;
    left:calc( 50vw - ( var(--text-input-width) / 2 ) );
    top: 5rem;
    width: var(--text-input-width);
    height: var(--text-input-height);
    resize: none;
    box-sizing: border-box;
    margin:0;
    padding:1rem;
    border-radius: 1rem;
    border:1px solid black;
    background-color: var(--white);
}
#multiline-text-input-overlay .overlay-text-input:focus {
    outline:none;
    box-shadow: 0 0 1rem 0 var(--white);
}
#multiline-text-input-overlay .overlay-close-button {
    left:calc( 50vw - ( var(--text-input-width) / 2 ) );
}
#multiline-text-input-overlay .overlay-apply-button:hover,
#multiline-text-input-overlay .overlay-accept-button:hover {
    box-shadow: 0 0 1rem 0 var(--white);
}
#multiline-text-input-overlay .overlay-apply-button,
#multiline-text-input-overlay .overlay-accept-button {
    position:absolute;
    left:calc( 50vw + ( ( var(--text-input-width) / 2 ) - 6rem ) );
    top: calc( 6rem + var(--text-input-height) );
    width: 6rem;
    height: 3rem;
    border-radius: 1rem;
    background-color: var(--high);
    background-image: url('icon/check-black.png');
    background-size:contain;
    background-position:center;
    background-repeat:no-repeat;
    box-sizing: border-box;
}


#number-input-overlay .overlay-number-input {
    position:absolute;
    left:calc( 50vw - ( min( 100vw, 100vh ) / 6 ) );
    top: 5rem;
    width: calc( min( 100vw, 100vh ) / 3 );
    height: 2rem;
    resize: none;
    box-sizing: border-box;
    margin:0;
    padding:1rem;
    border-radius: 1rem;
    border:1px solid black;
    background-color: var(--white);
    text-align: center;
}
#number-input-overlay .overlay-number-input:focus {
    outline:none;
    box-shadow: 0 0 1rem 0 var(--white);
}
#number-input-overlay .overlay-apply-button:hover {
    box-shadow: 0 0 1rem 0 var(--white);
}
#number-input-overlay .overlay-apply-button {
    position:absolute;
    left:calc( ( 50vw + ( min( 100vw, 100vh ) / 6 ) ) - 6rem );
    top: 8rem;
    width: 6rem;
    height: 3rem;
    border-radius: 1rem;
    background-color: var(--high);
    background-image: url('icon/check-black.png');
    background-size:contain;
    background-position:center;
    background-repeat:no-repeat;
    box-sizing: border-box;
}


#filename-input-overlay .overlay-filename-input {
    position:absolute;
    left:calc( 50vw - ( min( 100vw, 100vh ) / 6 ) );
    top: 5rem;
    width: calc( min( 100vw, 100vh ) / 3 );
    height: 2rem;
    resize: none;
    box-sizing: border-box;
    margin:0;
    padding:1rem;
    border-radius: 1rem;
    border:1px solid black;
    background-color: var(--white);
    text-align: center;
}
#filename-input-overlay .overlay-filename-input:focus {
    outline:none;
    box-shadow: 0 0 1rem 0 var(--white);
}
#filename-input-overlay .overlay-apply-button:hover {
    box-shadow: 0 0 1rem 0 var(--white);
}
#filename-input-overlay .overlay-apply-button {
    position:absolute;
    left:calc( ( 50vw + ( min( 100vw, 100vh ) / 6 ) ) - 6rem );
    top: 8rem;
    width: 6rem;
    height: 3rem;
    border-radius: 1rem;
    background-color: var(--high);
    background-image: url('icon/save.png');
    background-size:contain;
    background-position:center;
    background-repeat:no-repeat;
    box-sizing: border-box;
}

#asset-browser-container {
    --asset-layout-gap: 1rem;
    --asset-list-height: calc( ( 100vh - 3rem ) - var(--asset-layout-gap ) );
    --asset-list-width: 50vw;
    --asset-preview-width: 50vw;
    --asset-search-height: 3rem;
    --asset-close-button-height: 3rem;
}
#asset-browser-container .overlay-close-button:hover {
    border: 1px solid var(--white);
}
#asset-browser-container .overlay-close-button {
    position:absolute;
    left: var(--asset-layout-gap);
    top: var(--asset-layout-gap);
    width: var(--asset-close-button-height);
    height: var(--asset-close-button-height);
    border-radius: 1rem;
    background-image: url('icon/x.png');
    background-size:2rem;
    background-position:center;
    background-repeat:no-repeat;
    border: 1px solid transparent;
}
#asset-browser-search-bar {
    position:absolute;
    width: calc( var(--asset-list-width) - ( var(--asset-layout-gap) * 1.5 ) );
    height: var(--asset-search-height);
    left: var(--asset-layout-gap);
    top: calc( ( var( --asset-layout-gap ) + var(--asset-close-button-height) ) + var(--asset-layout-gap) );
    background-color: var(--dark);
    border-radius: 1.5rem;
    border:1px solid var(--low-mid);
    box-sizing: border-box;
    box-shadow: 0 0 1rem 0 var(--very-dark);
    padding: 0 1rem;
}
#asset-browser-search-bar > img {
    position: absolute;
    height: 2rem;
    top: 0.5rem;
    right: 1rem;
}
#asset-browser-search-bar .placeholder {
    position: absolute;
    height: 2rem;
    top: 0.5rem;
    left: 1.5rem;
    opacity: 0.5;
    color: var(--white);
    font-size: 1rem;
    display: flex;
    flex-direction: row;
    justify-content: flex-start;
    align-items: center;
    line-height: 0;
}
#asset-browser-tags-bar {
    position:absolute;
    width: calc( 35vw - 1rem );
    height: 2rem;
    left: 10vw;
    top: calc( 5vh + 4rem );
    background-color: var(--dark);
    border-radius: 0.5rem;
    border:1px solid var(--low-mid);
    box-sizing: border-box;
    box-shadow: 0 0 1rem 0 var(--very-dark);
    padding: 0 1rem;
}
#asset-browser-tags-bar .placeholder {
    position: absolute;
    height: 2rem;
    top: 0;
    left: 1rem;
    opacity: 0.5;
    color: var(--white);
    font-size: 0.67rem;
    display: flex;
    flex-direction: row;
    justify-content: flex-start;
    align-items: center;
    line-height: 0;
}
#asset-browser-search-tags-bar {
    position:absolute;
    width: calc( 15vw - 1rem );
    height: 2rem;
    left: 45vw;
    top: calc( 5vh + 4rem );
    background-color: var(--dark);
    border-radius: 1.5rem;
    border:1px solid var(--low-mid);
    box-sizing: border-box;
    box-shadow: 0 0 1rem 0 var(--very-dark);
    padding: 0 1rem;
}
#asset-browser-search-tags-bar > img {
    position: absolute;
    height: 1rem;
    top: 0.5rem;
    right: 0.5rem;
}
#asset-browser-search-tags-bar .placeholder {
    position: absolute;
    height: 2rem;
    top: 0;
    left: 1rem;
    opacity: 0.5;
    color: var(--white);
    font-size: 0.67rem;
    display: flex;
    flex-direction: row;
    justify-content: flex-start;
    align-items: center;
    line-height: 0;
}
#asset-browser-list {
    position:absolute;
    width: calc( ( var(--asset-list-width) - var(--asset-layout-gap) ) - ( var(--asset-layout-gap) / 2.0 ) );
    --space-above: calc( (var(--asset-layout-gap) * 3) + ( var(--asset-search-height) + var(--asset-close-button-height) ) );
    height: calc( var(--asset-list-height) - ( var(--space-above) + var(--asset-layout-gap) ) );
    left: var(--asset-layout-gap);
    top: var(--space-above);
    background-color: var(--dark);
    border-radius: 1rem;
    border:1px solid var(--low-mid);
    box-sizing: border-box;
    box-shadow: 0 0 1rem 0 var(--very-dark);
    overflow-y: scroll;
    padding:0.5rem;
}
#asset-browser-list > .asset-element:hover {
    border: 1px solid var(--white);
}
#asset-browser-list > .asset-element.active {
    background-color: var(--low);
    border: 1px solid var(--white);
}
#asset-browser-list > .asset-element {
    background-color: var(--very-dark);
    border: 1px solid transparent;
    margin-bottom:0.5rem; padding:0;
    width:100%;
    min-height:1.5rem;
    font-size: 1rem;
    box-sizing: border-box;
    display: flex;
    flex-direction: row;
    justify-content: center;
    align-items: center;
    text-align: center;
    color:var(--white);
    border-radius: 0.5rem;
}
#asset-browser-preview {
    position:absolute;
    --space-below: calc( (var(--asset-layout-gap) * 2) + var(--asset-close-button-height) );
    width: calc( ( var(--asset-list-width) - var(--asset-layout-gap) ) - ( var(--asset-layout-gap) / 2.0 ) );
    height: calc( (var(--asset-list-height) - var(--space-below )) - var(--asset-layout-gap) );
    right: var(--asset-layout-gap);
    top: var(--asset-layout-gap);
    padding:1rem;
    background-color: var(--dark);
    border-radius: 1rem;
    border:1px solid var(--low-mid);
    box-sizing: border-box;
    box-shadow: 0 0 1rem 0 var(--very-dark);
    color: var(--white);
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    text-align: center;
    font-size: 1.67rem;
}
#asset-browser-apply-button:hover {
    box-shadow: 0 0 1rem 0 var(--white);
}
#asset-browser-apply-button {
    position:absolute;
    right: var(--asset-layout-gap);
    top: calc( var(--asset-list-height) - ( var(--asset-close-button-height) + var(--asset-layout-gap)) );
    width: calc( var(--asset-close-button-height) * 2.0 );
    height: var(--asset-close-button-height);
    border-radius: 1rem;
    background-color: var(--high);
    background-image: url('icon/check-black.png');
    background-size:contain;
    background-position:center;
    background-repeat:no-repeat;
    box-sizing: border-box;
}

#console {
    display: none;
    box-sizing: border-box;
    position:absolute;
    right:1rem;
    bottom:1rem;
    padding:0.5rem;
    border:1px solid red;
    font-size:14px;
    color:red;
    text-align: right;
    overflow: hidden;
    z-index: 1000000;
    pointer-events:none;
    white-space: pre-wrap;
}

.unimplemented, .unimplemented span, .unimplemented div, .unimplemented .tooltip {
    color: rgb(231, 206, 95) !important;
    /* text-decoration: line-through !important; */
}

#air-input {
    position: absolute;
    left: 0; top: 0;
    width: 1rem; height: 1rem;
    overflow: visible;
    --size: 100px;
}
#air-input > .ring::before {
    content: " ";
    position: absolute;
    left:calc( ( -0.3 * var(--size) ) - 0px );
    top:calc( ( -0.3 * var(--size) ) - 0px );
    width:calc( var(--size) + 0px );
    height:calc( var(--size) + 0px );
    border-radius: calc( 0.5 * ( var(--size) + 0px ) );
    border: 1px solid black;
    box-sizing: border-box;
}
#air-input > .ring::after {
    content: " ";
    position: absolute;
    left:0;
    top:0;
    --insize: calc( ( 0.4 * var(--size) ) + 2px );
    width:var(--insize);
    height:var(--insize);
    border-radius: calc( 0.5 * var(--insize) );
    border: 1px solid black;
    box-sizing: border-box;
}
#air-input > .ring {
    position: absolute;
    left:calc( -0.5 * var(--size) );
    top:calc( -0.5 * var(--size) );
    width:var(--size);
    height:var(--size);
    border-radius: calc( 0.5 * var(--size) );
    border: calc( 0.3 * var(--size)) solid rgba(255,255,255,0.5);
    box-sizing: border-box;
    background-color: transparent;
}

#home-row {
    position: absolute;
    left:0; top:0;
    padding: var(--button-gap);
    height: calc( ( 2 * var(--button-gap) ) + var(--button-size) );
    width:15rem;
    gap: var(--button-gap);
    box-sizing: border-box;
    justify-content: flex-start;
    align-items: center;
    overflow: visible;
    z-index: 12000;
}
#home-row > div {
    position: relative;
    z-index: 13000;
}
.home-row-enter-fullscreen-button { background-image: url('icon/contract.png'); }
.home-row-enter-fullscreen-button.fullscreen { background-image: url('icon/expand.png'); }
.home-row-file-button { background-image: url('icon/folder.png'); }
.home-row-settings-button { background-image: url('icon/gear.png'); }
/*.home-row-save-button { background-image: url('icon/save.png'); }
.home-row-load-button { background-image: url('icon/open.png'); }
.home-row-export-button { background-image: url('icon/export-image.png'); }*/

#tools-column {
    position: absolute;
    left:0;
    top:calc( ( 2 * var(--button-gap) ) + var(--button-size) );
    bottom:calc( ( 2 * var(--button-gap) ) + var(--button-size) );
    padding: var(--button-gap);
    width: calc( ( 2 * var(--button-gap) ) + var(--button-size ) );
    height: calc( 100vh - ( 2 * ( ( 2 * var(--button-gap) ) + var(--button-size) ) ) );
    gap: var(--button-gap);
    box-sizing: border-box;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    overflow: visible;
}
.tools-column-generate-button { background-image: url('icon/magic.png'); }
.tools-column-ai-tools-button { background-image: url('icon/mtool-wand.png'); }
.tools-column-paint-button { background-image: url('icon/brush.png'); }
.tools-column-vector-button { background-image: url('icon/path.png'); }
.tools-column-select-button { background-image: url('icon/select-free.png'); }
.tools-column-mask-button { background-image: url('icon/mask.png'); }
.tools-column-transform-button { background-image: url('icon/move.png'); }
.tools-column-flood-fill-button { background-image: url('icon/paint-bucket.png'); }
.tools-column-text-tool-button { background-image: url('icon/text.png'); }
.tools-column-pose-button { background-image: url('icon/rig.png'); }
.tools-column-color-adjust-button { background-image: url('icon/adjust.png'); }

.round-toggle.unavailable { opacity: 0.25; }
.round-toggle.unavailable.hovering { border:1px solid transparent; }


#filters-controls-row.hidden {
    opacity: 0;
    transform: scale(0.9,0.9);
}
#filters-controls-row {
    top:0.5rem;
    position:absolute;
    left: var(--file-row-width);
    width:calc( 100vw - ( var(--layers-row-width) + var(--file-row-width) ) );
    z-index: 7000;
}

#generative-controls-row.hidden {
    opacity: 0;
    transform: scale(0.9,0.9);
}
#generative-controls-row {
    top:var(--button-gap);
    position:absolute;
    left: var(--file-row-width);
    width:calc( 100vw - ( var(--layers-row-width) + var(--file-row-width) ) );
    z-index: 7000;
}
#api-flow-selector-button {
    position: absolute;
    left:0; top:0;
    width:var(--button-size);
    height:var(--button-size);
    z-index: 11000;
}

#generative-controls-images-inputs-panel {
    position: absolute !important;
    right:10.2rem;
    top:-0.5rem;
    width:10rem; /* modify from js */
    position: relative;
    flex-shrink: 0;
    flex-grow: 0;
    display: block;
    padding: 0;
    margin: 0;
    text-align: center;
    box-sizing: border-box;
    z-index:10500;
}
.image-input-control:last-child {
    margin-right: 0;
}
.image-input-control .image-control-element-label {
    position: absolute;
    left:0; top:-1rem;
    height: 1rem;
    transform-origin: bottom left;
    transform: rotate( 90deg );
    width: 2.6rem;
    text-align: center;
    color: var(--white);
    font-size: 0.67rem;
    line-height: 0;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    text-wrap: nowrap;
    word-wrap: nowrap;
}
.image-input-control.drop-hovering {
    border:1px solid var(--white);
}
.image-input-control {
    border:1px solid transparent;
    position: relative;
    margin-right:0.5rem;
    width:1rem;
    height:3.5rem;
    background-color: var(--dark);
    box-shadow: 0 0 0.25rem 0 black;
    background-image: url('icon/picture.png');
    background-position: bottom center;
    background-size: contain;
    background-repeat: no-repeat;
    display: inline-block;
    border-bottom-left-radius: 0.5rem;
    border-bottom-right-radius: 0.5rem;
}

#generative-controls-panel {
    position: absolute;
    left:calc( var(--button-size) + ( 2 * var(--button-gap) ) );
    top:0;
    width:calc( 100% - var(--file-row-width) ); /* modded from js to pose i2i nodes @ end of setupUIGenerativeControls() */
    position: relative;
    flex-shrink: 0;
    flex-grow: 0;
    display: flex;
    flex-direction: row;
    justify-content: stretch;
    align-items: flex-start;
    padding: 0;
    padding-right: var(--button-gap);
    margin: 0;
    box-sizing: border-box;
    gap:var(--button-gap);
    flex-wrap: wrap;
    z-index:10000;
}
#generate-button .generate-label { transform: scale(1,1); }
#generate-button.pushed .generate-label { transform: scale(0.9,0.9); }
#generate-button {
    flex-shrink: 0;
    background-color: var(--dark);
    color: var(--white);
    filter:invert(0.99);
    font-size: 1.167rem;
    letter-spacing: 1px;
    border-radius: calc( var(--button-size) * 0.4 );
    line-height: 0;
    text-align: center;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    position:absolute;
    right:0; top:0;
    width:var(--generate-button-width);
    height:var(--button-size);
    box-sizing: border-box;
    padding:0; margin:0;
    background-position: center;
    background-size: contain;
    background-repeat: no-repeat;
    /* font-family: Georgia, 'Times New Roman', Times, serif; */
}
@media (width < 800px) {
    #ui {
        --generate-button-width: var(--button-size);
    }
    #generate-button {
        color: transparent;
        background-image: url('icon/magic.png');
    }
}

#generative-controls-panel div.hidden {
    display: none;
}
#generative-controls-panel .text-input-control-text {
    width:100%;
    height:var(--button-size);
    box-sizing: border-box;
    white-space:nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    line-height: var(--button-size);
}
.control-element-label {
    position: absolute;
    left:-0.33rem; top:-0.33rem;
    max-width: 100%;
    color:var(--white);
    background-color: var(--dark);
    box-shadow:
        0 0 0.5rem 0 var(--dark),
        0 0 0.25rem 0 var(--dark),
        0 0 0.125rem 0 var(--dark)
        ;
    height:1rem;
    line-height: 1rem;
    padding: 0 0.5rem;
    box-sizing: border-box;
    font-size: 0.67rem;
    border-radius: 0.5rem;
    white-space: nowrap;
    text-wrap: nowrap;
    word-wrap: nowrap;
    text-overflow: hidden;
    text-align: left;
    text-overflow: ellipsis;
}
#generative-controls-panel .text-input-control {
    position: relative;
    flex-grow:1;
    min-width:var(--button-size);
    height:var(--button-size);
    background-color: var(--mid);
    border:1px solid var(--high-mid);
    box-sizing: border-box;
    border-radius: calc( var(--button-size) * 0.4 );
    font-stretch: condensed;
    letter-spacing: -1px;
    padding:0.25rem 0.33rem;
    line-height: 0;
    display: flex;
    flex-direction: row;
    justify-content: flex-start;
    align-items: center;
    color: var(--very-dark);
    flex-basis: 48%;
    z-index: 9000;
}
.generative-controls-retractable-slider-left-arrow { background-image: url('icon/arrow-left.png'); }
.generative-controls-retractable-slider-right-arrow { background-image: url('icon/arrow-right.png'); }
.generative-controls-retractable-slider-left-arrow,
.generative-controls-retractable-slider-right-arrow {
    flex-grow: 0;
    width:1rem;
    height:var(--button-size);
    background-repeat: no-repeat;
    background-size: contain;
    background-position: center;
}
.generative-controls-retractable-slider-number-preview {
    flex-grow: 1;
}
.generative-controls-retractable-slider {
    position: relative;
    flex-grow: 0;
    width:5rem;
    height:var(--button-size);
    background-color: var(--mid);
    border:1px solid var(--high-mid);
    box-sizing: border-box;
    border-radius: 1rem;
    line-height: 0;
    display: flex;
    flex-direction: row;
    justify-content: center;
    align-items: center;
    text-align: center;
    color: var(--very-dark);
    z-index: 8000;
}

#color-adjust-tools-options-row.hidden {
    opacity: 0;
    transform: scale(0.9,0.9);
}
#color-adjust-tools-options-row > div {
    position: relative;
    z-index: 6000;
}
#color-adjust-tools-options-row {
    position:absolute;
    left: var(--file-row-width);
    width:calc( 100vw - ( var(--layers-row-width) + var(--file-row-width) ) );
    height:3.5rem;
    justify-content: center;
    align-items: center;
    gap:var(--button-gap);
    z-index: 5000;
}
#color-adjust-tools-options-row .long {
    flex-grow: 0;
    width: 3.8rem;
    min-width: unset;
    flex-basis: unset;
    overflow: visible;
    text-overflow: unset;
}


#transform-tools-options-row.hidden {
    opacity: 0;
    transform: scale(0.9,0.9);
}
#transform-tools-options-row > div {
    position: relative;
    z-index: 6000;
}
#transform-tools-options-row {
    position:absolute;
    left: var(--file-row-width);
    width:calc( 100vw - ( var(--layers-row-width) + var(--file-row-width) ) );
    height:3.5rem;
    justify-content: center;
    align-items: center;
    gap:var(--button-gap);
    z-index: 5000;
}
#transform-tools-options-row > div.hidden.animated {
    transition:
        opacity var(--animation-speed),
        transform var(--animation-speed),
        background-color var(--animation-speed),
        border-color var(--animation-speed),
        filter var(--animation-speed),
        background-size var(--animation-speed),
        top var(--animation-speed),
        width 0s var(--animation-speed),
        height 0s var(--animation-speed);
    
}
#transform-tools-options-row > div.hidden {
    width:1px;
    height:1px;
    transform: scale( 0.1, 0.1 );
    opacity: 0;
}

#pose-rig-container {
    position: absolute;
    left: 0; top:0;
    width: 100vw;
    height: 100vh;
}
#pose-rig-container > .pose-rig-handle {
    position: absolute;
    width: 1rem; height: 1rem;
    border-radius: 0.5rem;
    border:1px solid white;
    box-shadow: 0 0 1rem 1px black;
    box-sizing: border-box;

    /* Properties set from JS */
    left: 0; top:0;
    background-color: red;
}

#transform-handles-container {
    position: absolute;
    left: 0; top:0;
    width: 100vw;
    height: 100vh;
}
#transform-handles-container > .transform-handle {
    position: absolute;
    width: 1rem; height: 1rem;
    border-radius: 0.5rem;
    border:1px solid white;
    box-shadow: 0 0 1rem 1px var(--very-dark);
    box-sizing: border-box;

    /* Properties set from JS */
    left: 0; top:0;
    background-color: var(--high-mid);
}

#flood-fill-tools-options-row.hidden {
    opacity: 0;
    transform: scale(0.9,0.9);
}
#flood-fill-tools-options-row > div {
    position: relative;
    z-index: 6000;
}
#flood-fill-tools-options-row {
    position:absolute;
    left: var(--file-row-width);
    width:calc( 100vw - ( var(--layers-row-width) + var(--file-row-width) ) );
    height:3.5rem;
    justify-content: center;
    align-items: center;
    gap:var(--button-gap);
    z-index: 5000;
}
.flood-fill-options-erase-toggle { background-image: url('icon/eraser-v2.png'); }
.flood-fill-options-color-toggle { background-image: url('icon/three-circles.png'); }

#lasso-tools-options-row.hidden {
    opacity: 0;
    transform: scale(0.9,0.9);
}
#lasso-tools-options-row > div {
    position: relative;
    z-index: 6000;
}
#lasso-tools-options-row {
    position:absolute;
    left: var(--file-row-width);
    width:calc( 100vw - ( var(--layers-row-width) + var(--file-row-width) ) );
    height:3.5rem;
    justify-content: center;
    align-items: center;
    gap:var(--button-gap);
    z-index: 5000;
}
.lasso-options-lasso-change-shape.free-shape { background-image: url('icon/lasso-shape-free.png'); }
.lasso-options-lasso-change-shape.ellipse-shape { background-image: url('icon/lasso-shape-ellipse.png'); }
.lasso-options-lasso-change-shape.rect-shape { background-image: url('icon/lasso-shape-rect.png'); }
.lasso-options-lasso-change-shape.eyedropper-shape { background-image: url('icon/lasso-shape-eyedropper.png'); }
.lasso-options-cancel-lasso { background-image: url('icon/cancel-lasso.png'); }
.lasso-options-invert-lasso { background-image: url('icon/invert-lasso.png'); }
.lasso-options-cut-lassoed-area { background-image: url('icon/cut-lassoed-area.png'); }
.lasso-options-duplicate-lassoed-area { background-image: url('icon/duplicate-lassoed-area.png'); }
.lasso-options-delete-lassoed-area { background-image: url('icon/delete-lassoed-area.png'); }

#lasso-shape-panel {
    --lasso-shape-panel-width: 17rem;
    position: absolute;
    right: calc( ( var(--lasso-shape-panel-width) / -2.0 ) + 0.707rem );
    top: calc( 100% + 1rem );
    width: var(--lasso-shape-panel-width);
    height:10rem;
    background-color: var(--dark);
    overflow: visible;
    border-radius: 1rem;
    border-top-right-radius: 0;
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    align-items: stretch;
    padding: 0.5rem;
    box-sizing: border-box;
    gap:0.5rem;
    z-index: 22000;
    box-shadow: 0 0 1rem 1px black;
}
#lasso-shape-panel > .summon-marker {
    position: absolute;
    right:calc( 50% - 0.5rem ); top:0;
    width:1rem; height:1rem;
    transform-origin: top right;
    transform: rotate( 45deg );
    background-color:  var(--dark);
}
#lasso-shape-panel.hidden {
    opacity: 0;
    transform: scale(0.9,0.9) translate( 5%, -10% );
}
#lasso-shape-panel > .spacer {
    flex-grow: 0;
    flex-shrink: 0;
    width:100%;
    height:2px;
    background-color: var(--low-mid);
}


#pose-tools-options-row.hidden {
    opacity: 0;
    transform: scale(0.9,0.9);
}
#pose-tools-options-row > div {
    position: relative;
    z-index: 6000;
}
#pose-tools-options-row {
    position:absolute;
    left: var(--file-row-width);
    width:calc( 100vw - ( var(--layers-row-width) + var(--file-row-width) ) );
    height:3.5rem;
    justify-content: stretch;
    align-items: center;
    gap:var(--button-gap);
    z-index: 5000;
}
.pose-tools-options-move-children-toggle { background-image: url('icon/move.png'); }

#paint-tools-options-row.hidden {
    opacity: 0;
    transform: scale(0.9,0.9);
}
#paint-tools-options-row > div {
    position: relative;
    z-index: 6000;
}
#paint-tools-options-row {
    position:absolute;
    top: 0;
    left: var(--file-row-width);
    width:calc( 100vw - ( var(--file-row-width) + var(--layers-row-width) ) );
    height:calc( var(--button-size) + ( 2 * var(--button-gap ) ) );
    display: flex;
    justify-content: center;
    align-items: center;
    gap:var(--button-gap);
    z-index: 5000;
}
#paint-tools-options-row > .flex-row > .flex-row {
    position: absolute;
    left:0; top:0;
    width:100%; height:100%;
    gap: var(--button-gap);
}
#paint-tools-options-row > .flex-row > .flex-row.hidden {
    flex-grow: 0;
    transform: scale(0.9);
    opacity: 0;
    overflow: hidden;
}
#paint-tools-options-row > .flex-row.tool-options-container {
    flex-grow: 1;
    position: relative;
    width: auto;
    max-width: 25rem;
    justify-self: stretch;
    position: relative;
    height: 3.5rem;
    gap:var(--button-gap);
    z-index:5000;
    overflow: visible;
}
.paint-tools-options-brushes-button { background-image: url('icon/brushes-cup.png'); }
.paint-tools-options-paint-mode { background-image: url('icon/brush.png'); }
.paint-tools-options-blend-mode { background-image: url('icon/finger.png'); }
.paint-tools-options-erase-mode { background-image: url('icon/eraser-v2.png'); }
.paint-tools-options-retractable-slider.hovering {
    border: 1px solid white;;
}
.paint-tools-options-retractable-slider {
    height:var(--button-size);
    width:var(--button-size);
    flex-grow: 0;
    border-radius: calc( var(--button-size ) * 0.5 );
    background-color: var(--mid);
    border: 1px solid transparent;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
}
.paint-tools-options-retractable-opacity-slider {
    background-image: url('icon/opacity-grid.png');
    background-size: cover;
    background-position: center;
    background-repeat: repeat;
}
.paint-tools-options-preview-number {
    position:absolute;
    left:calc( 50% - 1.25rem );
    width:var(--button-size);
    height: 1rem;
    text-align: center;
    overflow: visible;
    top:calc( 100% + 0.25rem );
    color: white;
    font-size: 1rem;
    text-shadow:
        0 0 0.125rem black,
        0 0 0.25rem black,
        0 0 0.5rem black;
}
.paint-tools-options-brush-size-preview-core {
    border:2px solid var(--very-dark);
    border-radius: 50%;
    box-sizing: border-box;
    width:50%;
    height:50%;
}
.paint-tools-options-brush-softness-preview-core {
    background-color: var(--very-dark);
    border-radius: 50%;
    box-sizing: border-box;
    width:50%;
    height:50%;
    filter: blur(0.1rem);
}
.paint-tools-options-brush-opacity-preview-core {
    background-color: rgb(128,128,128);
    border-radius: 50%;
    box-sizing: border-box;
    width:67%;
    height:67%;
    opacity: 0.5;
}
.paint-tools-options-color-well.hidden {
    opacity: 0;
    transform: scale(0.9,0.9);
}
.paint-tools-options-color-well {
    height:var(--button-size);
    width:var(--button-size);
    flex-grow: 0;
    flex-shrink: 0;
    border-radius: calc( var(--button-size) * 0.5 );
    background-color: var(--mid);
    border: 1px solid var(--very-dark);
}

.color-wheel.hidden {
    opacity: 0;
    transform: scale(0.9,0.9);
}
.color-wheel {
    position:absolute;
    background-color: transparent;
    --size:256px;
    left:0; top:0;
    width:var(--size);
    height:var(--size);
    overflow: hidden;
    z-index: 1000000;
}
.color-wheel > div.base-color {
    position:absolute;
    width:var(--size); height:var(--size);
    left: 0; top: 0;
    background-color: red;
    border-radius: 1rem;
}
.color-wheel > img.upper-slot {
    position:absolute;
    width:var(--size); height:calc( var(--size) / 2 );
    left: 0; top: 0;
    mix-blend-mode: saturation;
    opacity: 1;
}
.color-wheel > img.lower-slot {
    position:absolute;
    width:var(--size); height:calc( var(--size) / 2 );
    left: 0; top: calc( var(--size) / 2 );
    mix-blend-mode: luminosity;
}
.color-wheel > img.base {
    position:absolute;
    width:var(--size); height:var(--size);
    left: 0; top: 0;
    border-radius: 1rem;
}
.color-wheel > .color-preview {
    position:absolute;
    width:calc( var(--size) / 3 ); height:calc( var(--size) / 3 );
    left: calc(  var(--size) / 3 );
    top: calc(  var(--size) / 3 );
    border-radius: calc( var(--size) / 6 );
    box-shadow: 0 0 2px 2px black;
    background-color: red;
    box-sizing: border-box;
}
.color-wheel > div.nubs-overlay {
    position:absolute;
    width:var(--size); height:var(--size);
    left: 0;
    top: 0;
}
.nubs-overlay > .color-nub {
    position:absolute;
    left:0; top:0;
    width:calc( var(--size)*0.05 );
    height:calc( var(--size)*0.05 );
    border-radius:calc( var(--size)*0.025 );
    background-color: white;
    box-shadow: 0 0 2px 2px black;
}

.flex-row {
    display: flex;
    flex-direction: row;
    justify-content: center;
    align-items: center;
}

#layers-above-row {
    position: absolute;
    right: 0; top: 0;
    padding: var(--button-gap);
    height: calc( ( 2 * var(--button-gap) ) + var(--button-size) );
    width: calc( var(--button-gap) + ( 2 * ( var(--button-gap) + var(--button-size) ) ) );
    gap: var(--button-gap);
    box-sizing: border-box;
    justify-content: flex-end;
    overflow: visible;
    z-index: 20000;
}

.animated {
    transition:
        opacity var(--animation-speed),
        transform var(--animation-speed),
        background-color var(--animation-speed),
        border-color var(--animation-speed),
        filter var(--animation-speed),
        background-size var(--animation-speed),
        top var(--animation-speed);
}

.tooltip-holder {
    position: relative;
    overflow: visible;
}
.tooltip-holder.hovering > .tooltip {
    opacity: 1;
}
.tooltip-holder > .tooltip > img {
    height: 0.67rem;
}
.tooltip-holder > .tooltip {
    height: 1.5rem;
    font-size: 0.67rem;
    line-height: 1rem;
    background-color: var(--very-dark);
    border:1px solid white;
    box-sizing: border-box;
    position:absolute;
    padding: 0.25rem;
    white-space: nowrap;
    max-width: 50vw;
    overflow: hidden;
    text-overflow: ellipsis;
    color: var(--white);
    opacity: 0;
    z-index: 10000000;
    display: flex;
    flex-direction: row;
    justify-content: center;
    align-items: center;
}
.tooltip.below { top: calc( 100% + 0.5rem ); }
.tooltip.above { bottom: calc( 100% + 0.5rem ); }
.tooltip.to-left { right: calc( 100% + 0.5rem ); }
.tooltip.to-right { left: calc( 100% + 0.5rem ); }
.tooltip.to-left-of-center { right: 50%; }
.tooltip.to-right-of-center { left: 50%; }
.tooltip.below-center { top: 50%; }
.tooltip.above-center { bottom: 50%; }
.tooltip.vertical-center { top: calc( 50% - 0.75rem ); }
/* .tooltip.horizontal-center {} */

#show-layers-button {
    background-image: url('icon/layers.png');
}

.vertical-spacer {
    flex-grow: 0;
    flex-shrink: 0;
    height: var(--button-size);
    width: 1px;
    background-color: var(--dark);
    border-radius: 1px;
    box-sizing: border-box;
    border:0; margin:0; padding:0;
}

.round-toggle.long > div.button-text {
    height: 1.67rem;
    width:100%;
    line-height: 1.67rem;
    white-space: nowrap;
    box-sizing: border-box;
    overflow: hidden;
    text-overflow: ellipsis;
}
.round-toggle.long {
    position: relative;
    flex-grow:1;
    width: auto;
    min-width:var(--button-size);
    font-stretch: condensed;
    letter-spacing: -1px;
    padding:var(--button-gap) 0.67rem;
    line-height: 0;
    display: flex;
    flex-direction: row;
    justify-content: flex-start;
    align-items: center;
    color: var(--white);
    flex-basis: max( 15%, 5rem );
    z-index: 8000;
}
.round-toggle .control-element-label {
    color:var(--dark);
    background-color: var(--high-mid);
    box-shadow:
        0 0 0.5rem 0 var(--white),
        0 0 0.25rem 0 var(--white),
        0 0 0.125rem 0 var(--white)
        ;
}
.round-toggle {
    position: relative;
    flex-grow: 0;
    flex-shrink: 0;
    height:var(--button-size);
    width:var(--button-size);
    flex-grow: 0;
    border-radius: calc( var(--button-size) * 0.4 );
    background-color: transparent;
    background-size: calc( var(--button-size ) - ( 2 * var(--button-gap) ) );
    background-position: center;
    background-repeat: no-repeat;
    opacity: 1;
    transform: scale(1,1);
    border: 1px solid transparent;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    line-height: 0;
    color: var(--white);
    box-sizing: border-box;
    z-index: 8000;
}
.round-toggle.on {
    background-color: var(--dark);
}
.round-toggle.hidden {
    opacity: 0;
    transform: scale(0.67,0.67);
}
.round-toggle.hovering {
    border-color: var(--white);
}
.round-toggle.pushed {
    background-size: 1.35rem;
}
#add-layer-button {
    background-image: url('icon/add.png');
    overflow: visible;
    position: relative;
    z-index: 21000;
}

#ai-tools-panel {
    position: absolute;
    left: calc( 100% + 1rem );
    --panel-height:9.3rem;
    top: calc( 50% - ( var(--panel-height) / 2.0 ) );
    width: 25rem;
    height:var(--panel-height);
    background-color: var(--dark);
    overflow: visible;
    border-radius: 1rem;
    border-top-left-radius: 0;
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    align-items: stretch;
    padding: 0.5rem;
    box-sizing: border-box;
    gap:var(--button-gap);
    z-index: 22000;
    box-shadow: 0 0 1rem 1px black;
}
#ai-tools-panel > .summon-marker {
    position: absolute;
    left:-0.707rem; top:50%;
    width:1rem; height:1rem;
    transform-origin: top left;
    transform: rotate( -45deg );
    background-color: var(--dark);
}
#ai-tools-panel.hidden {
    opacity: 0;
    transform: scale(0.9,0.9) translate( -5%, 0 );
}
#ai-tools-panel > .spacer {
    flex-grow: 0;
    flex-shrink: 0;
    width:100%;
    height:2px;
    background-color: var(--low-mid);
}

#file-panel {
    position: absolute;
    left: calc( 50% - 0.707rem );
    top: calc( 100% + 1rem );
    width: 17rem;
    height:9.3rem;
    background-color: var(--dark);
    overflow: visible;
    border-radius: 1rem;
    border-top-left-radius: 0;
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    align-items: stretch;
    padding: 0.5rem;
    box-sizing: border-box;
    gap:var(--button-gap);
    z-index: 22000;
    box-shadow: 0 0 1rem 1px black;
}
#file-panel > .summon-marker {
    position: absolute;
    left:0; top:0;
    width:1rem; height:1rem;
    transform-origin: top left;
    transform: rotate( -45deg );
    background-color: var(--dark);
}
#file-panel.hidden {
    opacity: 0;
    transform: scale(0.9,0.9) translate( 5%, -10% );
}
#file-panel > .spacer {
    flex-grow: 0;
    flex-shrink: 0;
    width:100%;
    height:2px;
    background-color: var(--low-mid);
}

#add-layers-panel {
    position: absolute;
    right: calc( 50% - 0.707rem );
    top: calc( 100% + 1rem );
    width: 17rem;
    height:22.5rem;
    background-color: var(--dark);
    overflow: visible;
    border-radius: 1rem;
    border-top-right-radius: 0;
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    align-items: stretch;
    padding: 0.5rem;
    box-sizing: border-box;
    gap:0.5rem;
    z-index: 22000;
    box-shadow: 0 0 1rem 1px black;
}
#add-layers-panel > .summon-marker {
    position: absolute;
    right:0; top:0;
    width:1rem; height:1rem;
    transform-origin: top right;
    transform: rotate( 45deg );
    background-color:  var(--dark);
}
#add-layers-panel.hidden {
    opacity: 0;
    transform: scale(0.9,0.9) translate( 5%, -10% );
}
#add-layers-panel > .spacer {
    flex-grow: 0;
    flex-shrink: 0;
    width:100%;
    height:2px;
    background-color: var(--low-mid);
}

.rounded-line-button {
    flex-grow: 1;
    height: var(--button-size);
    border-radius: calc( var(--button-size) * 0.4 );
    width:100%;
    padding: var(--button-gap);
    display: flex;
    flex-direction: row;
    justify-content: stretch;
    align-items: center;
    text-align: center;
    background-color: transparent;
    box-sizing: border-box;
}
.rounded-line-button > span {
    flex-grow: 1;
    text-align: center;
    color: var(--white);
}
.rounded-line-button > img {
    flex-grow: 0;
    height: 1.5rem;
    margin: 0 0.5rem;
}
.rounded-line-button.hovering {
    background-color: var(--low-mid);
}
.rounded-line-button.pushed {
    transform: scale(0.9,0.9);
}

#layers-column {
    position: absolute;
    right:0; top:0rem;
    width:15rem;
    box-sizing: border-box;
    height: 4rem;
    pointer-events: none !important;
    overflow: visible;
    padding:0; margin: 0;
    z-index: 100;
}
#layers-column.hidden {
    opacity: 0;
    transform: translate( 0, -1rem );
}

.layer-button.hovering {
    border: 1px solid rgba(255,255,255,0.5);
}
#layers-column > .layer-button.active {
    box-shadow: 0 0 0.5rem 0 rgba(0,0,0,0.5);
    border:1px solid var(--white);
}
#layers-column > .layer-button.selected {
    border:1px dashed var(--white);
}

.layer-group-joiner {
    display: none;
}
.layer-button.layer-in-group > .layer-group-joiner {
    display: block;
    position: absolute;
    left: 0.5rem;
    top: -0.5rem;
    width: 1px;
    height: 0.5rem;
    background-color: var(--white);
}
.layer-button {
    --layerWidth: 14rem;
    --margin-left: 0.5rem;
}
.layer-button.layer-in-group { --layerWidth: 13.5rem; --margin-left: 1.0rem; }
.layer-button.layer-in-group.layer-group-depth-2 { --layerWidth: 13.0rem; --margin-left: 1.5rem; }
.layer-button.layer-in-group.layer-group-depth-3 { --layerWidth: 12.5rem; --margin-left: 2.0rem; }
.layer-button.layer-in-group.layer-group-depth-4 { --layerWidth: 12.0rem; --margin-left: 2.5rem; }
.layer-button.layer-in-group.layer-group-depth-5 { --layerWidth: 11.5rem; --margin-left: 3.0rem; }
.layer-button {
    position: relative;
    width:var(--layerWidth);
    height:4rem;
    border:1px solid transparent;
    background-color: var(--dark);
    margin:0.5rem;
    margin-left: var(--margin-left);
    border-radius: 0.5rem;
    box-sizing: border-box;

    /* is this flex info ever used though? maybe for the canvases? */
    display: flex;
    flex-direction: row;
    justify-content: flex-start;
    align-items: center;
    padding: 0.25rem;
    gap: 0.25rem;

    z-index: 110;
    --layer-button-size:1rem;
    --layer-button-gap:0.25rem;
}
.layer-button.active > .layer-name { background-color: var(--low); }
.layer-name .layer-name-text {
    display: block;
    position: relative;
    width:100%;
    text-align: center;
    overflow: hidden;
    text-overflow: ellipsis;
    padding: 0;
    white-space: nowrap;
}
.layer-name.hovering { border:1px solid var(--white);}
.layer-name {
    text-shadow:
        0 0 0.125rem black,
        0 0 0.25rem black,
        0 0 0.5rem black;
    border-radius: 0.5rem;
    border:1px solid transparent;
    height:var(--layer-button-size);
    flex-grow: 1;
    box-sizing: border-box;
    display: flex;
    flex-direction: row;
    flex-wrap: nowrap;
    white-space: nowrap;
    justify-content: center;
    align-items: center;
    text-align: center;
    color: var(--white);
    font-size: 10px;
}

.layer-blend-mode .layer-blend-mode-text {
    display: block;
    position: relative;
    width:100%;
    text-align: center;
    overflow: hidden;
    text-overflow: ellipsis;
    padding: 0;
    white-space: nowrap;
}
.layer-blend-mode.hovering { border:1px solid var(--white);}
.layer-blend-mode.hidden {
    opacity: 0;
    transform: scale(0.9,0.9);
}
.layer-blend-mode {
    background-color: var(--low); 
    text-shadow:
        0 0 0.125rem black,
        0 0 0.25rem black,
        0 0 0.5rem black;
    border-radius: 0.5rem;
    border:1px solid transparent;
    height:var(--layer-button-size);
    flex-grow: 1;
    box-sizing: border-box;
    display: flex;
    flex-direction: row;
    flex-wrap: nowrap;
    white-space: nowrap;
    justify-content: center;
    align-items: center;
    text-align: center;
    color: var(--white);
    font-size: 10px;
    flex-grow: 1;
    flex-basis: 1rem;
}
.layer-button > canvas {
    max-height: 3.5rem;
    max-width: 3.5rem;
    box-shadow: 0 0 1rem 0 black;
}

.blend-mode-panel {
    position: absolute;
    right: calc( 100% + 3rem );
    --blend-mode-panel-height:9.3rem;
    width: 12rem;
    height:var(--blend-mode-panel-height);
    background-color: var(--dark);
    overflow: visible;
    border-radius: 1rem;
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    align-items: stretch;
    padding: 0.5rem;
    box-sizing: border-box;
    gap:var(--button-gap);
    z-index: 22000;
    box-shadow: 0 0 1rem 1px black;
}
.blend-mode-panel.center { top: calc( 50% - ( var(--blend-mode-panel-height) / 2.0 ) ); }
.blend-mode-panel.center > .summon-marker { top:50%; }
.blend-mode-panel.above { bottom: calc( 100% - 1.5rem ); }
.blend-mode-panel.above > .summon-marker { bottom:0.0625rem; }
.blend-mode-panel.below { top: calc( 100% - 1.5rem ); }
.blend-mode-panel.below > .summon-marker { top:1.0625rem; }
.blend-mode-panel > .summon-marker {
    position: absolute;
    right:-0.5rem;
    width:1rem; height:1rem;
    transform-origin: top right;
    transform: rotate( 45deg );
    background-color:  var(--dark);
}
.blend-mode-panel.hidden {
    opacity: 0;
    transform: scale(0.9,0.9) translate( 5%, 0 );
}
.blend-mode-panel > .spacer {
    flex-grow: 0;
    flex-shrink: 0;
    width:100%;
    height:2px;
    background-color: var(--low-mid);
}

.layer-button .layer-type-icon {
    height: 1rem;
    width: 1rem;
    background-position: center;
    background-size: contain;
    background-repeat: no-repeat;
    position: absolute;
    left:-1.5rem;
    top:0;
}
.layer-button .layer-type-icon.paint {  background-image: url('icon/brush.png'); }
.layer-button .layer-type-icon.generative {  background-image: url('icon/magic.png'); }
.layer-button .layer-type-icon.text {  background-image: url('icon/text.png'); }
.layer-button .layer-type-icon.pose {  background-image: url('icon/rig.png'); }
.layer-button .layer-type-icon.group {  background-image: url('icon/folder.png'); }
.layer-button .layer-type-icon.group.open { background-image: url('icon/open-folder.png'); }

.layer-button .layer-select-icon {
    height: 1rem;
    width: 1rem;
    background-image: url('icon/dashed-box.png'); 
    background-position: center;
    background-size: contain;
    background-repeat: no-repeat;
    position: absolute;
    left:-1.5rem;
    bottom:0.05rem;
}
.layer-button.active .layer-select-icon,
.layer-button.selected .layer-select-icon {
    background-image: url('icon/checked-box.png'); 
}

.layer-button.hover-drop-above > .layer-upper-dropzone { opacity: 1; transform: scale( 1,1 ); }
.layer-button.hover-drop-below > .layer-lower-dropzone { opacity: 1; transform: scale( 1,1 ); }
.layer-button.layer-in-group.hover-drop-below > .layer-lower-dropzone-group-joiner { opacity: 1; }
.layer-lower-dropzone { bottom: -0.33rem; }
.layer-upper-dropzone { top: -0.33rem; }
.layer-upper-dropzone, .layer-lower-dropzone {
    position: absolute;
    left: 0.5rem;
    width: calc( 100% - 1rem );
    height: 1px;
    border-radius: 1px;
    box-shadow: 0 0 0.25rem 0 var(--white);
    opacity: 0;
    transform: scale( 0.9,1 );
    background-color: var(--white);
}
.layer-lower-dropzone-group-joiner {
    position: absolute;
    left: 0.5rem;
    bottom: -0.33rem;
    width: 1px;
    height: 0.33rem;
    border-radius: 1px;
    box-shadow: 0 0 0.25rem 0 var(--white);
    opacity: 0;
    background-color: var(--white);
}
.layer-button-header-row { top:0; }
.layer-button-footer-row { bottom:0; }
.layer-button-header-row, .layer-button-footer-row {
    position:absolute;
    left:0;
    width:100%;
    height:calc( var(--layer-button-size) + ( 2 * var(--layer-button-gap) ) );
    display: flex;
    flex-direction: row;
    justify-content: stretch;
    align-items: stretch;
    gap: var(--layer-button-gap);
    padding: var(--layer-button-gap);
    box-sizing: border-box;
}

.layer-opacity-slider.hidden {
    opacity: 0;
    transform: scale(0.9,0.9);
}
.layer-ui-button.hidden {
    display: none;
}
.layer-ui-button.hovering { border:1px solid white; }
.layer-ui-button {
    position: relative;
    flex-grow: 0;
    width:var(--layer-button-size);
    height:var(--layer-button-size);
    border-radius: var(--layer-button-gap);
    background-repeat: no-repeat;
    background-size: var(--layer-button-size);
    background-position: center;
    border: 1px solid transparent;
}
.layer-visibility-button {
    background-color: var(--low-mid);
    background-image: url('icon/eye.png');
}
.layer-visibility-button.off {
    background-color: transparent;
    background-image: url('icon/eye-x.png');
}
.layer-alpha-lock-button {
    background-size: cover;
    background-color: transparent;
    background-image: url('icon/alpha-unlock.png');
}
.layer-alpha-lock-button.locked {
    background-color: var(--low-mid);
    background-image: url('icon/alpha-lock.png');
}
.layer-duplicate-button { background-image: url('icon/duplicate-layer.png'); }
.layer-delete-button { background-image: url('icon/trash.png'); }
.layer-merge-button { background-image: url('icon/merge-layer-down.png'); }
.layer-convert-to-paint-button { background-image: url('icon/to-paint.png'); }
.layer-flatten-group-button { background-image: url('icon/flatten-layers.png'); }
.layer-move-button { background-image: url('icon/move.png'); }
.layer-button .layer-opacity-slider {
    flex-grow: 1;
    height: calc( var(--layer-button-size) - ( 2 * var(--layer-button-gap) ) );
    margin: var(--layer-button-gap) 0;
}
.layer-node-link-source.hovering {
    background-color: var(--low);
}
.layer-button.active > .layer-node-link-source {
    box-shadow: 0 0 0.5rem 0 rgba(0,0,0,0.5);
    border: 1px solid white;
    border-right: 0;
}
.layer-node-link-source.hidden {
    opacity: 0;
    transform: scale(0.9,0.9);
}
.layer-node-link-source {
    border: 1px solid transparent;
    border-right: 0;
    box-sizing: border-box;
    position: absolute;
    left:calc( -2rem - 1px );
    top:calc(50%-0.75rem);
    width:2rem;
    height:1.5rem;
    background-color: var(--dark);
    background-image: url('icon/picture.png');
    background-repeat: no-repeat;
    background-size: 1rem;
    background-position: center;
    border-top-left-radius: 0.5rem;
    border-bottom-left-radius: 0.5rem;
}
.layer-node-tail.hidden {
    opacity: 0;
}
.layer-node-tail.faded {
    border-left: 2px dashed white;
}
.layer-node-tail {
    position: absolute;
    bottom: 50%;
    right: 100%;
    width:5rem;
    height:10rem;
    border-bottom-left-radius:1rem;
    border-bottom: 2px solid white;
    border-left: 2px solid white;
    border-top: 0; border-right: 0;
}

.slider {
    position: relative;
    background-color: var(--low-mid);
    border: 1px solid var(--dark);
    box-sizing: border-box;
    border-radius:0.25rem;
    height:0.5rem;
}
.slider > .nub {
    position: absolute;
    left:50%;
    top:0;
    height:0.5rem;
    width:0.5rem;
    border-radius: 0.25rem;
    background-color: var(--white);
    margin-left:-0.5rem;
}


.number-slider-left-arrow { background-image: url('icon/arrow-left.png'); }
.number-slider-right-arrow { background-image: url('icon/arrow-right.png'); }
.number-slider-left-arrow,
.number-slider-right-arrow {
    flex-grow: 0;
    width:1rem;
    height:var(--button-size);
    background-repeat: no-repeat;
    background-size: contain;
    background-position: center;
}
.number-slider-number-preview {
    flex-grow: 1;
}
.number-slider {
    position: relative;
    flex-grow: 0;
    width:5rem;
    height:var(--button-size);
    background-color: var(--mid);
    border:1px solid var(--high-mid);
    box-sizing: border-box;
    border-radius: calc( var(--button-size) * 0.4 );
    line-height: 0;
    display: flex;
    flex-direction: row;
    justify-content: center;
    align-items: center;
    text-align: center;
    color: var(--very-dark);
    z-index: 8000;
}
.number-slider-label {
    position: absolute;
    left:calc( -1.5 * var(--button-gap) );
    top:calc( -1.5 * var(--button-gap) );
    background-color: var(--dark);
    box-shadow:
        0 0 0.5rem 0 var(--dark),
        0 0 0.25rem 0 var(--dark),
        0 0 0.125rem 0 var(--dark)
        ;
    height:calc( 3 * var(--button-gap) );
    line-height: calc( 3 * var(--button-gap) );
    max-width: 100%;
    overflow: hidden;
    padding: 0 calc( 0.5 * var(--button-gap) );
    box-sizing: border-box;
    font-size: 0.67rem;
    white-space: nowrap;
    color:var(--white);
    border-radius: var(--button-gap);
    text-overflow: ellipsis;
    text-align: left;
}

#bottom-left-row {
    position: absolute;
    left:0rem; bottom:0rem;
    padding:var(--button-gap);
    box-sizing: border-box;
    height:calc( var(--button-height) + ( var(--button-gap) * 2 ) );
    width:calc( var(--button-gap) + ( 7 * ( var(--button-size) + var(--button-gap) ) ) );
    gap:var(--button-gap);
}

#gen-history-button { background-image: url('icon/gen-history.png'); }
#animation-timeline-button { background-image: url('icon/animation-timeline.png'); }

#undo-button, #undo-apikey-button { background-image: url('icon/undo.png'); }
#redo-button, #redo-apikey-button { background-image: url('icon/redo.png'); }
#canvas-zoom-rotate-reset-button { background-image: url('icon/view-reset.png'); }

#undo-apikey-button, #redo-apikey-button {
    float:right;
    position:relative;
    border:1px solid transparent;
}
#undo-apikey-button.unavailable:hover, #redo-apikey-button.unavailable:hover {
    border-color:transparent;
}
#undo-apikey-button:hover, #redo-apikey-button:hover {
    border-color:var(--white);
}
#undo-apikey-button::after { content: "Undo"; }
#redo-apikey-button::after { content: "Redo"; }
#undo-apikey-button::after, #redo-apikey-button::after {
    opacity:0;
    transition: opacity var(--animation-speed);
    height: 1.5rem;
    font-size: 0.67rem;
    line-height: 1rem;
    background-color: var(--very-dark);
    border:1px solid var(--white);
    box-sizing: border-box;
    position:absolute;
    bottom: calc( 100% + 0.5rem );
    left: 50%;
    padding: 0.25rem;
    white-space: nowrap;
    max-width: 50vw;
    overflow: hidden;
    text-overflow: ellipsis;
    color: var(--white);
    z-index: 10000000;
    display: flex;
    flex-direction: row;
    justify-content: center;
    align-items: center;
}
#undo-apikey-button:hover::after, #redo-apikey-button:hover::after { opacity:1; }

        </style>
    </head>
    <body>

        <script type="text/javascript">
            const scr = document.body.appendChild( document.createElement( "script" ) );
            scr.src = "canvas.js?v=" + parseInt( 100000000 * Math.random() );
        </script>

    </body>
</html>